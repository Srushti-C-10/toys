<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
   xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

	<?include $(sys.CURRENTDIR)\Common.wxi?>

	<?define NewPlusTemplateFilesPath=$(var.BinDir)WinUI3Apps\NewPlusTemplates\?>
	<?define NewPlusTemplateSubFilesPath=$(var.BinDir)WinUI3Apps\NewPlusTemplates\Project folder\?>

	<Fragment>

		<!-- Example templates -->
		<DirectoryRef Id="LocalAppDataProductFolder">
			<Directory Id="NewPlusInstallFolder" Name="New+">
				<Directory Id="NewPlusTemplatesInstallFolder" Name="Templates">
					<Directory Id="NewPlusTemplatesSubInstallFolder" Name="Project folder"/>
				</Directory>
			</Directory>
		</DirectoryRef>
		<DirectoryRef Id="NewPlusTemplatesInstallFolder" FileSource="$(var.NewPlusTemplateFilesPath)">
			<Component Id="NewPlusTemplateFiles_Component" Win64="yes" Guid="39264075-4B7F-40E3-A76F-21E68576D43E">
				<RegistryKey Root="HKCU" Key="Software\Classes\powertoys\components">
					<RegistryValue Type="string" Name="NewPlusTemplateFiles_Component" Value="" KeyPath="yes"/>
				</RegistryKey>
				<File Id="NewPlusTemplateFiles_File_Markdown_file.md" Source="$(var.NewPlusTemplateFilesPath)\Markdown file.md" />
				<File Id="NewPlusTemplateFiles_File_PowerShell_script.ps1" Source="$(var.NewPlusTemplateFilesPath)\PowerShell script.ps1" />
			</Component>
		</DirectoryRef>
		<DirectoryRef Id="NewPlusTemplatesSubInstallFolder" FileSource="$(var.NewPlusTemplateSubFilesPath)">
			<Component Id="NewPlusTemplateSubFiles_Component" Win64="yes" Guid="7618E61C-CCB8-492F-B284-E1AE2954AF0B">
				<RegistryKey Root="HKCU" Key="Software\Classes\powertoys\components">
					<RegistryValue Type="string" Name="NewPlusTemplateSubFiles_Component" Value="" KeyPath="yes"/>
				</RegistryKey>
				<File Id="NewPlusTemplateSubFiles_File_Readme.md" Source="$(var.NewPlusTemplateSubFilesPath)\Readme.md" />
			</Component>
		</DirectoryRef>

		<ComponentGroup Id="NewPlusTemplatesComponentGroup">
			<Component Id="RemoveNewPlusTemplateFolder" Guid="3E9B15CA-A50C-42DA-977F-5E9914562FE7" Directory="NewPlusInstallFolder" >
				<RegistryKey Root="HKCU" Key="Software\Classes\powertoys\components">
					<RegistryValue Type="string" Name="RemoveNewPlusTemplateFolder" Value="" KeyPath="yes"/>
				</RegistryKey>
				<RemoveFolder Id="RemoveFolderNewPlusInstallFolder" Directory="NewPlusInstallFolder" On="uninstall"/>
				<RemoveFolder Id="RemoveFolderNewPlusTemplatesInstallFolder" Directory="NewPlusTemplatesInstallFolder" On="uninstall"/>
				<RemoveFolder Id="RemoveFolderNewPlusTemplatesSubInstallFolder" Directory="NewPlusTemplatesSubInstallFolder" On="uninstall"/>
			</Component>
			<ComponentRef Id="NewPlusTemplateFiles_Component" />
			<ComponentRef Id="NewPlusTemplateSubFiles_Component" />
    </ComponentGroup>

	</Fragment>
</Wix>
