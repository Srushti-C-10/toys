<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
   xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

	<?include $(sys.CURRENTDIR)\Common.wxi?>

	<?define NewPlusAssetsFiles=?>
	<?define NewPlusAssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\New\?>

	<?define NewPlusTemplateFiles=?>
	<?define NewPlusTemplateFilesPath=$(var.BinDir)WinUI3Apps\NewPlusTemplates\?>

	<?define NewPlusTemplateSubFiles=?>
	<?define NewPlusTemplateSubFilesPath=$(var.BinDir)WinUI3Apps\NewPlusTemplates\Project-folder\?>

	<Fragment>
		<DirectoryRef Id="WinUI3AppsAssetsFolder">
			<Directory Id="NewPlusAssetsInstallFolder" Name="New" />
		</DirectoryRef>

		<DirectoryRef Id="INSTALLFOLDER">
			<Directory Id="PowerToysInstallFolder" Name="PowerToys">
				<Directory Id="NewPlusInstallFolder" Name="New">
					<Directory Id="NewPlusTemplatesInstallFolder" Name="Templates">
						<Directory Id="NewPlusTemplatesSubInstallFolder" Name="Project-folder"/>
					</Directory>
				</Directory>
			</Directory>
		</DirectoryRef>

		<DirectoryRef Id="NewPlusAssetsInstallFolder" FileSource="$(var.NewPlusAssetsFilesPath)">
			<!-- Generated by generateFileComponents.ps1 -->
			<!--NewPlusAssetsFiles_Component_Def-->
		</DirectoryRef>

		<DirectoryRef Id="NewPlusTemplatesInstallFolder" FileSource="$(var.NewPlusTemplateFilesPath)">
			<!-- Generated by generateFileComponents.ps1 -->
			<!--NewPlusTemplateFiles_Component_Def-->
		</DirectoryRef>

		<DirectoryRef Id="NewPlusTemplatesSubInstallFolder" FileSource="$(var.NewPlusTemplateSubFilesPath)">
			<!-- Generated by generateFileComponents.ps1 -->
			<!--NewPlusTemplateSubFiles_Component_Def-->
		</DirectoryRef>


		<ComponentGroup Id="NewPlusComponentGroup">
			<Component Id="RemoveNewPlusFolder" Guid="4189C789-56EB-409D-912E-3F4F3F4F1FFA" Directory="WinUI3AppsAssetsFolder" >
				<RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
					<RegistryValue Type="string" Name="RemoveNewPlusFolder" Value="" KeyPath="yes"/>
				</RegistryKey>
				<RemoveFolder Id="RemoveFolderNewPlusAssetsFolder" Directory="NewPlusAssetsInstallFolder" On="uninstall"/>
				<RemoveFolder Id="RemoveFolderNewPlusInstallFolder" Directory="NewPlusInstallFolder" On="uninstall"/>
				<RemoveFolder Id="RemoveFolderNewPlusTemplatesInstallFolder" Directory="NewPlusTemplatesInstallFolder" On="uninstall"/>
				<RemoveFolder Id="RemoveFolderNewPlusTemplatesSubInstallFolder" Directory="NewPlusTemplatesSubInstallFolder" On="uninstall"/>
			</Component>
		</ComponentGroup>

	</Fragment>
</Wix>
