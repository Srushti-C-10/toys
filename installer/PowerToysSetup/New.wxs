<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension" >

	<?include $(sys.CURRENTDIR)\Common.wxi?>

	<?define NewAssetsFiles=?>
	<?define NewAssetsFilesPath=$(var.BinDir)WinUI3Apps\Assets\New\?>

	<Fragment>
		<DirectoryRef Id="WinUI3AppsAssetsFolder">
			<Directory Id="NewAssetsInstallFolder" Name="New" />
		</DirectoryRef>
		
		<DirectoryRef Id="NewAssetsInstallFolder" FileSource="$(var.NewAssetsFilesPath)">
			<!-- Generated by generateFileComponents.ps1 -->
			<!--NewAssetsFiles_Component_Def-->
			<!-- !Warning! Make sure to change Component Guid if you update something here -->
			<Component Id="Module_NewShellExtension" Guid="560532D9-C610-470E-BA9A-C61FCF533517" Win64="yes">
				<RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\CLSID\{69824FC6-4660-4A09-9E7C-48DA63C6CC0F}">
					<RegistryValue Type="string" Value="New Shell Extension Context Menu" />
					<RegistryValue Type="string" Name="ContextMenuOptIn" Value="" />
					<RegistryValue Type="string" Key="InprocServer32" Value="[WinUI3AppsInstallFolder]PowerToys.NewPlus.ShellExtension.dll" />
					<RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
				</RegistryKey>
				<RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\AllFileSystemObjects\ShellEx\ContextMenuHandlers\NewPlus.ShellExtension">
					<RegistryValue Type="string" Value="{69824FC6-4660-4A09-9E7C-48DA63C6CC0F}"/>
				</RegistryKey>
				<RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\Drive\ShellEx\ContextMenuHandlers\NewPlus.ShellExtension">
					<RegistryValue Type="string" Value="{69824FC6-4660-4A09-9E7C-48DA63C6CC0F}"/>
				</RegistryKey>
			</Component>
		</DirectoryRef>

		<ComponentGroup Id="NewComponentGroup">
			<Component Id="RemoveNewFolder" Guid="CA8A7593-8C73-48E2-AFF5-9C1DE624AF86" Directory="NewAssetsInstallFolder" >
				<RegistryKey Root="$(var.RegistryScope)" Key="Software\Classes\powertoys\components">
					<RegistryValue Type="string" Name="RemoveNewFolder" Value="" KeyPath="yes"/>
				</RegistryKey>
				<RemoveFolder Id="RemoveFolderNewAssetsFolder" Directory="NewAssetsInstallFolder" On="uninstall"/>
			</Component>
			<ComponentRef Id="Module_NewShellExtension" />
		</ComponentGroup>

	</Fragment>
</Wix>
