<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension"
     xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension" >

  <?define RepoDir="$(var.ProjectDir)..\..\" ?>
  <?define BinX64Dir="$(var.RepoDir)x64\$(var.Configuration)\" ?>
  <Product Id="*"
       Name="PowerToys (Preview)"
       Language="1033"
       Version="$(var.Version)"
       Manufacturer="Microsoft"
       UpgradeCode="42B84BF7-5FBF-473B-9C8B-049DC16F7708">

    <Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" InstallPrivileges="elevated" Platform="x64" />

    <MajorUpgrade DowngradeErrorMessage="A later version of [ProductName] is already installed." />

    <Upgrade Id="42B84BF7-5FBF-473B-9C8B-049DC16F7708">
      <UpgradeVersion
         Minimum="0.11.0" Maximum="$(var.Version)"
         Property="PREVIOUSVERSIONSINSTALLED"
         IncludeMinimum="yes" IncludeMaximum="no" />
    </Upgrade>

    <MediaTemplate EmbedCab="yes" />

    <Property Id="WINDOWSBUILDNUMBER" Secure="yes">
      <RegistrySearch Id="BuildNumberSearch" Root="HKLM" Key="SOFTWARE\Microsoft\Windows NT\CurrentVersion" Name="CurrentBuildNumber" Type="raw" />
    </Property>
    <Condition Message="This application is only supported on Windows 10 version 1803 (build 17134) or higher.">
      <![CDATA[(WINDOWSBUILDNUMBER >= 17134)]]>
    </Condition>

    <Icon Id="powertoys.exe" SourceFile="$(var.BinX64Dir)svgs\icon.ico"/>
    <Property Id="ARPPRODUCTICON" Value="powertoys.exe" />
    <Feature Id="CoreFeature" Title="PowerToys" AllowAdvertise="no" Absent="disallow" TypicalDefault="install"
             Description="Contains the Shortcut Guide and Fancy Zones features.">
      <ComponentGroupRef Id="CoreComponents" />
      <ComponentGroupRef Id="ResourcesComponents" />
      <ComponentGroupRef Id="LauncherComponents" />
    </Feature>
    <SetProperty Id="ARPINSTALLLOCATION" Value="[INSTALLFOLDER]" After="CostFinalize" />

    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <UI>
      <UIRef Id="WixUI_PTInstallDir"/>
      <Publish Dialog="ExitDialog"
            Control="Finish"
            Event="DoAction"
            Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
      <Publish Dialog="MaintenanceTypeDlg" Control="RemoveButton" Property="_REMOVE_ALL" Value="Yes">1</Publish>
      <Publish Dialog="UserExit" Control="Finish" Event="DoAction" Value="TelemetryLogInstallCancel">NOT Installed</Publish>
      <Publish Dialog="FatalError" Control="Finish" Event="DoAction" Value="TelemetryLogInstallFail">NOT Installed</Publish>
      <Publish Dialog="UserExit" Control="Finish" Event="DoAction" Value="TelemetryLogUninstallCancel">Installed AND _REMOVE_ALL="Yes"</Publish>
      <Publish Dialog="FatalError" Control="Finish" Event="DoAction" Value="TelemetryLogUninstallFail">Installed AND _REMOVE_ALL="Yes"</Publish>
      <Publish Dialog="UserExit" Control="Finish" Event="DoAction" Value="TelemetryLogRepairCancel">Installed AND NOT (_REMOVE_ALL="Yes")</Publish>
      <Publish Dialog="FatalError" Control="Finish" Event="DoAction" Value="TelemetryLogRepairFail">Installed AND NOT (_REMOVE_ALL="Yes")</Publish>
    </UI>
    <WixVariable Id="WixUIBannerBmp" Value="$(var.ProjectDir)\Bitmaps\banner.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="$(var.ProjectDir)\Bitmaps\dialog.bmp" />
    <WixVariable Id="WixUILicenseRtf" Value="$(var.RepoDir)\installer\License.rtf" />
    <Property Id="INSTALLSTARTMENUSHORTCUT" Value="1"/>
    <Property Id="CREATESCHEDULEDTASK" Value="1"/>
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOX" Value="1"/>
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch PowerToys" />
    <Property Id="WixShellExecTarget" Value="[#PowerToys.exe]" />
    <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />

    <Property Id ="EXISTINGPOWERRENAMEEXTPATH">
      <RegistrySearch Id="ExistingExtPath" Root="HKCR" Key="CLSID\{0440049F-D1DC-4E46-B27B-98393D79486B}\InprocServer32" Type="raw"/>
    </Property>
    <Property Id ="EXISTINGIMAGERESIZERPATH">
      <RegistrySearch Id="ExistingImageResizerPath" Root="HKCR" Key="CLSID\{51B4D7E5-7568-4234-B4BB-47FB3C016A69}\InprocServer32" Type="raw"/>
    </Property>

    <InstallUISequence>
      <Custom Action="DetectPrevInstallPath" After="CostFinalize" />
    </InstallUISequence>
    <InstallExecuteSequence>
      <Custom Action="SetRegisterPowerToysSchTaskParam" Before="RegisterPowerToysSchTask" />
      <Custom Action="RegisterPowerToysSchTask" After="InstallFiles">
        NOT Installed and CREATESCHEDULEDTASK = 1
      </Custom>
      <Custom Action="WixCloseApplications" Before="RemoveFiles" />
      <Custom Action="RemovePowerToysSchTasks" After="RemoveFiles" />
      <Custom Action="TelemetryLogInstallSuccess" After="InstallFinalize">
        NOT Installed
      </Custom>
      <Custom Action="TelemetryLogUninstallSuccess" After="InstallFinalize">
        Installed and (NOT UPGRADINGPRODUCTCODE) AND (REMOVE="ALL")
      </Custom>
    </InstallExecuteSequence>

    <CustomAction Id="SetRegisterPowerToysSchTaskParam"
                  Property="RegisterPowerToysSchTask"
                  Value="[#PowerToys.exe]" />

    <!-- Needs to Impersonate="no" and Execute="deferred" in order to run elevated. -->
    <CustomAction Id="RegisterPowerToysSchTask"
                  Return="ignore"
                  Impersonate="no"
                  Execute="deferred"
                  BinaryKey="PTCustomActions"
                  DllEntry="CreateScheduledTaskCA"
                   />

    <CustomAction Id="RemovePowerToysSchTasks"
                  Return="ignore"
                  Impersonate="no"
                  Execute="deferred"
                  BinaryKey="PTCustomActions"
                  DllEntry="RemoveScheduledTasksCA"
                   />

    <CustomAction Id="TelemetryLogInstallSuccess"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogInstallSuccessCA"
                   />

    <CustomAction Id="TelemetryLogInstallCancel"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogInstallCancelCA"
                   />

    <CustomAction Id="TelemetryLogInstallFail"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogInstallFailCA"
                   />

    <CustomAction Id="TelemetryLogUninstallSuccess"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogUninstallSuccessCA"
                   />

    <CustomAction Id="TelemetryLogUninstallCancel"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogUninstallCancelCA"
                   />

    <CustomAction Id="TelemetryLogUninstallFail"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogUninstallFailCA"
                   />

    <CustomAction Id="TelemetryLogRepairCancel"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogRepairCancelCA"
                   />

    <CustomAction Id="TelemetryLogRepairFail"
                  Return="ignore"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="TelemetryLogRepairFailCA"
                   />

    <CustomAction Id="DetectPrevInstallPath"
                  Return="check"
                  Impersonate="yes"
                  BinaryKey="PTCustomActions"
                  DllEntry="DetectPrevInstallPathCA"
                  />

    <!-- Close 'PowerToys.exe' before uninstall-->
    <Property Id="MSIRESTARTMANAGERCONTROL" Value="Disable" />
    <!-- Restart explorer.exe if we detect existing PowerRenameExt.dll or ImageResizerExt.dll installation -->
    <util:CloseApplication Target="explorer.exe" RebootPrompt="no" TerminateProcess="0">
      EXISTINGPOWERRENAMEEXTPATH OR EXISTINGIMAGERESIZERPATH
    </util:CloseApplication>
    <util:CloseApplication CloseMessage="yes" Target="PowerToys.exe" ElevatedCloseMessage="yes" RebootPrompt="no" TerminateProcess="0" />
  </Product>

  <Fragment>
    <Binary Id="PTCustomActions" SourceFile="$(var.PowerToysSetupCustomActions.TargetPath)" />
  </Fragment>

  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFiles64Folder">
        <Directory Id="INSTALLFOLDER" Name="PowerToys">
          <Directory Id="SvgsInstallFolder" Name="svgs"/>
          <Directory Id="ModulesInstallFolder" Name="modules">
            <!-- Resource file directories -->
            <?foreach Language in ar;bg;ca;cs;de;es;eu-ES;fr;he;hu;it;nb-NO;nl;pl;pt-BR;ru;sk;tr;zh-Hans?>
              <!--NB: Ids can't contain hyphens-->
              <?if $(var.Language) = eu-ES?>
                <?define IdSafeLanguage = eu_ES?>
              <?elseif $(var.Language) = nb-NO?>
                <?define IdSafeLanguage = nb_NO?>
              <?elseif $(var.Language) = pt-BR?>
                <?define IdSafeLanguage = pt_BR?>
              <?elseif $(var.Language) = zh-Hans?>
                <?define IdSafeLanguage = zh_Hans?>
              <?else?>
                <?define IdSafeLanguage = $(var.Language)?>
              <?endif?>
              <Directory Id="Resources$(var.IdSafeLanguage)Folder" Name="$(var.Language)" />
              <?undef IdSafeLanguage?>
            <?endforeach?>
            <Directory Id="FileExplorerPreviewInstallFolder" Name="FileExplorerPreview" />
            <Directory Id="LauncherInstallFolder" Name="launcher">
              <Directory Id="AssetsFolder" Name="Assets" />
              <Directory Id="LauncherImagesFolder" Name="Images" />
              <Directory Id="LauncherUIControlsFolder" Name="Microsoft.Toolkit.Uwp.UI.Controls" />
              <Directory Id="LauncherXamlUIFolder" Name="Microsoft.UI.Xaml">
                <Directory Id="XamlUIAssetsFolder" Name="Assets" />
              </Directory>
              <Directory Id="LauncherpinyindbFolder" Name="pinyindb" />
              <Directory Id="LauncherPluginsFolder" Name="Plugins">
                <Directory Id="CalculatorPluginFolder" Name="Wox.Plugin.Calculator">
                  <Directory Id="CalculatorImagesFolder" Name="Images" />
                  <Directory Id="CalculatorLanguagesFolder" Name="Languages" />
                  <Directory Id="CalculatorpinyindbFolder" Name="pinyindb" />
                </Directory>
                <Directory Id="FolderPluginFolder" Name="Wox.Plugin.Folder">
                  <Directory Id="FolderPluginImagesFolder" Name="Images" />
                  <Directory Id="FolderPluginLanguagesFolder" Name="Languages" />
                  <Directory Id="FolderPluginpinyindbFolder" Name="pinyindb" />
                </Directory>
                <Directory Id="ProgramPluginFolder" Name="Wox.Plugin.Program">
                  <Directory Id="ProgramImagesFolder" Name="Images" />
                  <Directory Id="ProgramLanguagesFolder" Name="Languages" />
                  <Directory Id="ProgrampinyindbFolder" Name="pinyindb" />
                </Directory>
                <Directory Id="ShellPluginFolder" Name="Wox.Plugin.Shell">
                  <Directory Id="ShellImagesFolder" Name="Images" />
                  <Directory Id="ShellLanguagesFolder" Name="Languages" />
                  <Directory Id="ShellpinyindbFolder" Name="pinyindb" />
                </Directory>
                <Directory Id="IndexerPluginFolder" Name="Microsoft.Plugin.Indexer">
                  <Directory Id="IndexerImagesFolder" Name="Images" />
                  <Directory Id="IndexerLanguagesFolder" Name="Languages" />
                  <Directory Id="IndexerpinyindbFolder" Name="pinyindb" />
                </Directory>
                <Directory Id="WindowWalkerPluginFolder" Name="Wox.Plugin.WindowWalker">
                  <Directory Id="WindowWalkerImagesFolder" Name="Images" />
                  <Directory Id="WindowWalkerLanguagesFolder" Name="Languages" />
                  <Directory Id="WindowWalkerpinyindbFolder" Name="pinyindb" />
                </Directory>
              </Directory>
              <Directory Id="LauncherPropertiesFolder" Name="Properties" />
              <?foreach Language in cs;de;es;fr;it;ja;ko;pl;pt-BR;ru;tr;zh-Hans;zh-Hant?>
                <!--NB: Ids can't contain hyphens-->
                <?if $(var.Language) = pt-BR?>
                  <?define IdSafeLanguage = pt_BR?>
                <?elseif $(var.Language) = zh-Hans?>
                  <?define IdSafeLanguage = zh_Hans?>
                <?elseif $(var.Language) = zh-Hant?>
                  <?define IdSafeLanguage = zh_Hant?>
                <?else?>
                  <?define IdSafeLanguage = $(var.Language)?>
                <?endif?>
                <Directory Id="LauncherResources$(var.IdSafeLanguage)InstallFolder" Name="$(var.Language)" />
                <?undef IdSafeLanguage?>
              <?endforeach?>
            </Directory>
          </Directory>
          <Directory Id="SettingsV2InstallFolder" Name="SettingsUIRunner">
            <Directory Id="SettingsV2ViewsInstallFolder" Name="Views"/>
            <Directory Id="SettingsV2StylesInstallFolder" Name="Styles"/>
            <Directory Id="SettingsV2PropertiesInstallFolder" Name="Properties"/>
            <Directory Id="SettingsV2AssetsInstallFolder" Name="Assets"/>
            <Directory Id="SettingsV2ControlsInstallFolder" Name="Controls"/>
            <Directory Id="SettingsV2XamlInstallFolder" Name="Microsoft.UI.Xaml">
              <Directory Id="SettingsV2XamlAssetsInstallFolder" Name="Assets" />
            </Directory>
            <?foreach Language in cs;de;es;fr;it;ja;ko;pl;pt-BR;ru;tr;zh-Hans;zh-Hant?>
              <!--NB: Ids can't contain hyphens-->
              <?if $(var.Language) = pt-BR?>
                <?define IdSafeLanguage = pt_BR?>
              <?elseif $(var.Language) = zh-Hans?>
                <?define IdSafeLanguage = zh_Hans?>
              <?elseif $(var.Language) = zh-Hant?>
                <?define IdSafeLanguage = zh_Hant?>
              <?else?>
                <?define IdSafeLanguage = $(var.Language)?>
              <?endif?>
              <Directory Id="SettingsV2Resources$(var.IdSafeLanguage)InstallFolder" Name="$(var.Language)" />
              <?undef IdSafeLanguage?>
            <?endforeach?>
          </Directory>
          <Directory Id="SettingsHtmlInstallFolder" Name="settings-html">
            <Directory Id="SettingsHtmlDistInstallFolder" Name="dist"/>
          </Directory>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder"/>
      <Directory Id="DesktopFolder" Name="Desktop"/>
   </Directory>
  </Fragment>

  <Fragment>
    <DirectoryRef Id="INSTALLFOLDER" FileSource="$(var.BinX64Dir)">
      <Component Id="powertoys_toast_clsid" Win64="yes">
        <RegistryKey Root="HKCR" Key="Software\Classes\CLSID\{DD5CACDA-7C2E-4997-A62A-04A597B58F76}">
          <RegistryValue Type="string" Value="PowerToys Toast Notifications Background Activator" />
          <RegistryValue Type="string" Key="LocalServer32" Value="[INSTALLFOLDER]PowerToys.exe -ToastActivated" />
          <RegistryValue Type="string" Key="LocalServer32" Name="ThreadingModel" Value="Apartment" />
        </RegistryKey>
      </Component>
      <Component Id="powertoys_exe" Guid="A2C66D91-3485-4D00-B04D-91844E6B345B" Win64="yes">
        <File Id="PowerToys.exe" KeyPath="yes" Checksum="yes">
          <Shortcut Id="ApplicationStartMenuShortcut"
                    Name="PowerToys (Preview)"
                    Description="PowerToys - Windows system utilities to maximize productivity"
                    Directory="ProgramMenuFolder"
                    Icon="powertoys.exe"
                    IconIndex="0"
                    Advertise="yes">
            <ShortcutProperty Key="System.AppUserModel.ID" Value="Microsoft.PowerToysWin32"/>
            <ShortcutProperty Key="System.AppUserModel.ToastActivatorCLSID" Value="{DD5CACDA-7C2E-4997-A62A-04A597B58F76}"/>
          </Shortcut>
        </File>

        <RegistryKey Root="HKCR" Key="powertoys">
          <RegistryValue Type="string" Name="URL Protocol" Value=""/>
          <RegistryValue Type="string" Value="URL:PowerToys custom internal URI protocol"/>
          <RegistryKey Key="DefaultIcon">
            <RegistryValue Type="string" Value="PowerToys.exe" />
          </RegistryKey>
          <RegistryKey Key="shell\open\command">
            <RegistryValue Type="string" Value="&quot;[INSTALLFOLDER]PowerToys.exe&quot; &quot;%1&quot;" />
          </RegistryKey>
        </RegistryKey>

        
      </Component>

      <Component Id="settings_exe" Guid="A5A461A9-7097-4CBA-9D39-3DBBB6B7B80C" Win64="yes">
        <File Id="PowerToysSettings.exe" KeyPath="yes" Checksum="yes" />
      </Component>
      <Component Id="notifications_dll" Guid="23B25EE4-BCA2-45DF-BBCD-82FBDF01C5AB" Win64="yes">
        <File Id="Notifications.dll" KeyPath="yes" Checksum="yes" />
      </Component>
      <Component Id="action_runner_exe" Guid="626ABB17-16F0-4007-9A58-6998724A5E14" Win64="yes">
        <File Id="action_runner.exe" KeyPath="yes" Checksum="yes" />
      </Component>
      <Component Id="License_rtf" Guid="3E5AE43B-CFB4-449B-A346-94CAAFF3312E" Win64="yes">
        <File Source="$(var.RepoDir)\installer\License.rtf" Id="License.rtf" KeyPath="yes" />
      </Component>
      <Component Id="powertoysinterop_dll" Guid="B7DD2DF4-C8F2-46FA-9571-D6EF1588ADF3" Win64="yes">
        <File Id="PowerToysInterop.dll" KeyPath="yes" Checksum="yes" />
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SvgsInstallFolder" FileSource="$(var.BinX64Dir)svgs\">
      <Component Id="PowerToysSvgs" Guid="7C4D4EED-9338-423D-992C-DCE02F3E2D35" Win64="yes">
        <File Source="$(var.BinX64Dir)svgs\0.svg" />
        <File Source="$(var.BinX64Dir)svgs\1.svg" />
        <File Source="$(var.BinX64Dir)svgs\2.svg" />
        <File Source="$(var.BinX64Dir)svgs\3.svg" />
        <File Source="$(var.BinX64Dir)svgs\4.svg" />
        <File Source="$(var.BinX64Dir)svgs\5.svg" />
        <File Source="$(var.BinX64Dir)svgs\6.svg" />
        <File Source="$(var.BinX64Dir)svgs\7.svg" />
        <File Source="$(var.BinX64Dir)svgs\8.svg" />
        <File Source="$(var.BinX64Dir)svgs\9.svg" />
        <File Source="$(var.BinX64Dir)svgs\no_active_window.svg" />
        <File Source="$(var.BinX64Dir)svgs\overlay.svg" />
        <File Source="$(var.BinX64Dir)svgs\overlay_portrait.svg" />
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="ModulesInstallFolder" FileSource="$(var.BinX64Dir)modules\">
      <Component Id="Module_ShortcutGuide" Guid="CBD0AC09-91D3-428E-B2B3-05745ADF3473" Win64="yes">
        <File Source="$(var.BinX64Dir)modules\shortcut_guide.dll" KeyPath="yes" />
      </Component>
      <Component Id="Module_FancyZones" Guid="C6B5272E-6ED4-4B80-B0E7-2FF0355D8CF4" Win64="yes">
        <File Source="$(var.BinX64Dir)modules\fancyzones.dll" KeyPath="yes" />
        <File Source="$(var.BinX64Dir)modules\FancyZonesEditor.exe" >
          <netfx:NativeImage Id="FancyZonesEditor.exe" Platform="64bit" Priority="0" />
        </File>
        <File Source="$(var.BinX64Dir)modules\ControlzEx.dll" />
        <File Source="$(var.BinX64Dir)modules\MahApps.Metro.dll" />
        <File Source="$(var.BinX64Dir)modules\Microsoft.Xaml.Behaviors.dll" />
        <File Source="$(var.BinX64Dir)modules\FancyZonesEditor.exe.config" />
        <File Source="$(var.BinX64Dir)modules\Microsoft.Bcl.AsyncInterfaces.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Buffers.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Memory.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Numerics.Vectors.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Runtime.CompilerServices.Unsafe.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Text.Encodings.Web.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Text.Json.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Threading.Tasks.Extensions.dll" />
        <File Source="$(var.BinX64Dir)modules\System.ValueTuple.dll" />
      </Component>
      <Component Id="Module_PowerRename" Guid="E4401D08-27FE-4F96-BA17-0C61FD79E684" Win64="yes">
        <File Source="$(var.BinX64Dir)modules\PowerRenameExt.dll" KeyPath="yes" />
        <RegistryKey Root="HKCR" Key="CLSID\{0440049F-D1DC-4E46-B27B-98393D79486B}">
          <RegistryValue Type="string" Value="PowerRename Shell Extension" />
          <RegistryValue Type="string" Key="InprocServer32" Value="[ModulesInstallFolder]PowerRenameExt.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Apartment" />
        </RegistryKey>
        <RegistryKey Root="HKCR" Key="AllFileSystemObjects\ShellEx\ContextMenuHandlers\PowerRenameExt">
          <RegistryValue Type="string" Value="{0440049F-D1DC-4E46-B27B-98393D79486B}"/>
        </RegistryKey>
      </Component>
      
      <Component Id="Module_Launcher" Guid="9A343236-B49D-451D-A27D-4C336F460A45" Win64="yes">
        <File Source="$(var.BinX64Dir)modules\Microsoft.Launcher.dll" />
      </Component>

      <Component Id="Module_KeyboardManager" Guid="9279BD82-786F-4F0B-8E49-DB484EE34C9B" Win64="yes">
        <File Source="$(var.BinX64Dir)modules\KeyboardManager.dll" />
      </Component>

      <Component Id="Module_ImageResizer" Guid="96E63289-759C-4A73-A56B-EE7429932F72" Win64="yes">
        <File Source="$(var.BinX64Dir)modules\ImageResizer.exe">
          <netfx:NativeImage Id="ImageResizer.exe" Platform="all" Priority="0" />
        </File>
        <File Source="$(var.BinX64Dir)modules\GalaSoft.MvvmLight.dll" />
        <File Source="$(var.BinX64Dir)modules\GalaSoft.MvvmLight.Platform.dll" />
        <File Source="$(var.BinX64Dir)modules\GalaSoft.MvvmLight.Extras.dll" />
        <File Source="$(var.BinX64Dir)modules\System.Windows.Interactivity.dll">
          <!-- NB: Needed since it's only referenced in XAML. -->
          <netfx:NativeImage Id="Interactivity" Platform="all" Priority="0"/>
        </File>
        <File Source="$(var.BinX64Dir)modules\Newtonsoft.Json.dll" />
        <File Source="$(var.BinX64Dir)modules\ImageResizerExt.dll" KeyPath="yes" />
      </Component>
      <Component Id="Module_ImageResizer_Registry" Guid="8B593E2C-2D9B-4EBC-93F7-A2B69707DAC9" Win64="yes">
        <RegistryKey Root="HKCR" Key="CLSID\{51B4D7E5-7568-4234-B4BB-47FB3C016A69}\InprocServer32">
          <RegistryValue Value="[ModulesInstallFolder]ImageResizerExt.dll" Type="string" />
          <RegistryValue Name="ThreadingModel" Value="Apartment" Type="string" />
        </RegistryKey>
        <!-- Registry Key for the drag and drop handler -->
        <RegistryValue Root="HKCR"
                       Key="Directory\ShellEx\DragDropHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <!-- Registry Keys for the context menu handler for each of the following image formats: bmp, dib, gif, jfif, jpe, jpeg, jpg, jxr, png, rle, tif, tiff, wdp  -->
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.bmp\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.dib\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.gif\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.jfif\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.jpe\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.jpeg\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.jpg\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.jxr\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.png\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.rle\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.tif\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.tiff\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
        <RegistryValue Root="HKCR"
                       Key="SystemFileAssociations\.wdp\ShellEx\ContextMenuHandlers\ImageResizer"
                       Value="{51B4D7E5-7568-4234-B4BB-47FB3C016A69}"
                       Type="string" />
      </Component>
      <Component Id="Module_PowerPreview_PerUserRegistry" Guid="CD90ADC0-7CD5-4A62-B0AF-23545C1E6DD3" Win64="yes">
        <!-- Added a separate component for Per-User registry changes -->
        <!-- Registry Key for Class Registration of Svg Preview Handler -->
        <RegistryKey Root="HKCR" Key="CLSID\{ddee2b8a-6807-48a6-bb20-2338174ff779}">
          <RegistryValue Type="string" Value="SvgPreviewHandler.SvgPreviewHandler" />
          <RegistryValue Type="string" Name="DisplayName" Value="Svg Preview Handler" />
          <RegistryValue Type="string" Name="AppID" Value="{CF142243-F059-45AF-8842-DBBE9783DB14}" />
          <RegistryValue Type="string" Key="Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value=""/>
          <RegistryValue Type="string" Key="InprocServer32" Value="mscoree.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="Assembly" Value="SvgPreviewHandler, Version=$(var.Version).0, Culture=neutral" />
          <RegistryValue Type="string" Key="InprocServer32" Name="Class" Value="SvgPreviewHandler.SvgPreviewHandler" />
          <RegistryValue Type="string" Key="InprocServer32" Name="RuntimeVersion" Value="v4.0.30319" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Both" />
          <RegistryValue Type="string" Key="InprocServer32" Name="CodeBase" Value="file:///[FileExplorerPreviewInstallFolder]SvgPreviewHandler.dll" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="Assembly" Value="SvgPreviewHandler, Version=$(var.Version).0, Culture=neutral" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="Class" Value="SvgPreviewHandler.SvgPreviewHandler" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="RuntimeVersion" Value="v4.0.30319" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="CodeBase" Value="file:///[FileExplorerPreviewInstallFolder]SvgPreviewHandler.dll" />
        </RegistryKey>
        <!-- Registry Key for Class Registration of Markdown Preview Handler -->
        <RegistryKey Root="HKCR" Key="CLSID\{45769bcc-e8fd-42d0-947e-02beef77a1f5}">
          <RegistryValue Type="string" Value="MarkdownPreviewHandler.MarkdownPreviewHandler" />
          <RegistryValue Type="string" Name="DisplayName" Value="Markdown Preview Handler" />
          <RegistryValue Type="string" Name="AppID" Value="{CF142243-F059-45AF-8842-DBBE9783DB14}" />
          <RegistryValue Type="string" Key="Implemented Categories\{62C8FE65-4EBB-45e7-B440-6E39B2CDBF29}" Value="" />
          <RegistryValue Type="string" Key="InprocServer32" Value="mscoree.dll" />
          <RegistryValue Type="string" Key="InprocServer32" Name="Assembly" Value="MarkdownPreviewHandler, Version=$(var.Version).0, Culture=neutral" />
          <RegistryValue Type="string" Key="InprocServer32" Name="Class" Value="MarkdownPreviewHandler.MarkdownPreviewHandler" />
          <RegistryValue Type="string" Key="InprocServer32" Name="RuntimeVersion" Value="v4.0.30319" />
          <RegistryValue Type="string" Key="InprocServer32" Name="ThreadingModel" Value="Both" />
          <RegistryValue Type="string" Key="InprocServer32" Name="CodeBase" Value="file:///[FileExplorerPreviewInstallFolder]MarkdownPreviewHandler.dll" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="Assembly" Value="MarkdownPreviewHandler, Version=$(var.Version).0, Culture=neutral" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="Class" Value="MarkdownPreviewHandler.MarkdownPreviewHandler" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="RuntimeVersion" Value="v4.0.30319" />
          <RegistryValue Type="string" Key="InprocServer32\$(var.Version).0" Name="CodeBase" Value="file:///[FileExplorerPreviewInstallFolder]MarkdownPreviewHandler.dll" />
        </RegistryKey>
        <!-- Registry Key for AppID registration -->
        <RegistryKey Root="HKCR" Key="AppID\{CF142243-F059-45AF-8842-DBBE9783DB14}">
          <RegistryValue Type="expandable" Name="DllSurrogate" Value="%SystemRoot%\system32\prevhost.exe" />
        </RegistryKey>
        <!-- Add Svg preview handler to preview handlers list -->
        <RegistryKey Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\PreviewHandlers">
          <RegistryValue Type="string" Name="{ddee2b8a-6807-48a6-bb20-2338174ff779}" Value="Svg Preview Handler" />
        </RegistryKey>
        <!-- Add Markdown preview handler to preview handlers list -->
        <RegistryKey Root="HKLM" Key="Software\Microsoft\Windows\CurrentVersion\PreviewHandlers">
          <RegistryValue Type="string" Name="{45769bcc-e8fd-42d0-947e-02beef77a1f5}" Value="Markdown Preview Handler" />
        </RegistryKey>
        <!-- Add file type association for Svg Preview Handler -->
        <RegistryKey Root="HKCR" Key=".svg\shellex">
          <RegistryValue Type="string" Key="{8895b1c6-b41f-4c1c-a562-0d564250836f}" Value="{ddee2b8a-6807-48a6-bb20-2338174ff779}" />
        </RegistryKey>
        <!-- Add file type association for Markdown Preview Handler -->
        <RegistryKey Root="HKCR" Key=".md\shellex">
          <RegistryValue Type="string" Key="{8895b1c6-b41f-4c1c-a562-0d564250836f}" Value="{45769bcc-e8fd-42d0-947e-02beef77a1f5}" />
        </RegistryKey>
        <!-- Update Key to use IE11 for prevhost.exe -->
        <RegistryKey Root="HKLM" Key="Software\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION">
          <RegistryValue Type="integer" Name="prevhost.exe" Value="11000" />
        </RegistryKey>
      </Component>
    </DirectoryRef>
    
    <DirectoryRef Id="FileExplorerPreviewInstallFolder" FileSource="$(var.RepoDir)\modules\FileExplorerPreview\">
      <Component Id="Module_PowerPreview" Guid="FF1700D5-1B07-4E07-9A62-4D206645EEA9" Win64="yes">
        <!-- Component to include PowerPreview Module Source dll's -->
        <!-- File to include PowerPreview Module native dll -->
        <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\powerpreview.dll" KeyPath="yes" />
        <!-- File to include common library used by preview handlers -->
        <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\PreviewHandlerCommon.dll" />
        <!-- File to include dll for Svg Preview Handler -->
        <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\SvgPreviewHandler.dll" />
        <!-- Files to include dll's for Markdown Preview Handler and it's dependencies -->
        <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\MarkdownPreviewHandler.dll" />
        <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\Markdig.Signed.dll" />
        <File Source="$(var.BinX64Dir)modules\FileExplorerPreview\HtmlAgilityPack.dll" />
        <!-- Dependencies generated by Markdig.Signed v0.20 -->
        <File Id="FileExplorerPreview_Buffers" Source="$(var.BinX64Dir)modules\FileExplorerPreview\System.Buffers.dll" />
        <File Id="FileExplorerPreview_Memory" Source="$(var.BinX64Dir)modules\FileExplorerPreview\System.Memory.dll" />
        <File Id="FileExplorerPreview_Numerics" Source="$(var.BinX64Dir)modules\FileExplorerPreview\System.Numerics.Vectors.dll" />
        <File Id="FileExplorerPreview_Unsafe" Source="$(var.BinX64Dir)modules\FileExplorerPreview\System.Runtime.CompilerServices.Unsafe.dll" />
      </Component>
    </DirectoryRef>

    <!-- SettingsV2 components -->
    <DirectoryRef Id="SettingsV2InstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\">
      <Component Id="SettingsV2" Guid="4B108DC0-4B2C-4AC4-AAA9-1B2DC8399F7C" Win64="yes">
        <!-- exe -->
        <File Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.PowerToys.Settings.UI.Runner.exe"/>
        <File Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.PowerToys.Settings.UI.exe"/>
        <!-- dll -->
        <?foreach File in Accessibility.dll;clrcompression.dll;clretwrc.dll;clrjit.dll;concrt140_app.dll;coreclr.dll;D3DCompiler_47_cor3.dll;dbgshim.dll;DirectWriteForwarder.dll;hostfxr.dll;hostpolicy.dll;Microsoft.Bcl.AsyncInterfaces.dll;Microsoft.CSharp.dll;Microsoft.DiaSymReader.Native.amd64.dll;Microsoft.PowerToys.Settings.UI.Lib.dll;Microsoft.PowerToys.Settings.UI.Runner.dll;Microsoft.Toolkit.dll;Microsoft.Toolkit.Uwp.dll;Microsoft.Toolkit.Uwp.UI.dll;Microsoft.Toolkit.Win32.UI.XamlHost.dll;Microsoft.Toolkit.Win32.UI.XamlHost.Managed.dll;Microsoft.Toolkit.Wpf.UI.Controls.dll;Microsoft.Toolkit.Wpf.UI.XamlHost.dll;Microsoft.UI.Xaml.dll;Microsoft.VisualBasic.Core.dll;Microsoft.VisualBasic.dll;Microsoft.Win32.Primitives.dll;Microsoft.Win32.Registry.AccessControl.dll;Microsoft.Win32.Registry.dll;Microsoft.Win32.SystemEvents.dll;Microsoft.Xaml.Interactions.dll;Microsoft.Xaml.Interactivity.dll;mscordaccore.dll;mscordaccore_amd64_amd64_4.700.20.11803.dll;mscordbi.dll;mscorlib.dll;mscorrc.debug.dll;mscorrc.dll;msvcp140_1_app.dll;msvcp140_2_app.dll;msvcp140_app.dll;netstandard.dll;Newtonsoft.Json.dll;PenImc_cor3.dll;PowerToysInterop.dll;PresentationCore.dll;PresentationFramework.Aero.dll;PresentationFramework.Aero2.dll;PresentationFramework.AeroLite.dll;PresentationFramework.Classic.dll;PresentationFramework.dll;PresentationFramework.Luna.dll;PresentationFramework.Royale.dll;PresentationNative_cor3.dll;PresentationUI.dll;ReachFramework.dll;System.AppContext.dll;System.Buffers.dll;System.CodeDom.dll;System.Collections.Concurrent.dll;System.Collections.dll;System.Collections.Immutable.dll;System.Collections.NonGeneric.dll;System.Collections.Specialized.dll;System.ComponentModel.Annotations.dll;System.ComponentModel.DataAnnotations.dll;System.ComponentModel.dll;System.ComponentModel.EventBasedAsync.dll;System.ComponentModel.Primitives.dll;System.ComponentModel.TypeConverter.dll;System.Configuration.ConfigurationManager.dll;System.Configuration.dll;System.Console.dll;System.Core.dll;System.Data.Common.dll;System.Data.DataSetExtensions.dll;System.Data.dll;System.Design.dll;System.Diagnostics.Contracts.dll;System.Diagnostics.Debug.dll;System.Diagnostics.DiagnosticSource.dll;System.Diagnostics.EventLog.dll;System.Diagnostics.FileVersionInfo.dll;System.Diagnostics.PerformanceCounter.dll;System.Diagnostics.Process.dll;System.Diagnostics.StackTrace.dll;System.Diagnostics.TextWriterTraceListener.dll;System.Diagnostics.Tools.dll;System.Diagnostics.TraceSource.dll;System.Diagnostics.Tracing.dll;System.DirectoryServices.dll;System.dll;System.Drawing.Common.dll;System.Drawing.Design.dll;System.Drawing.dll;System.Drawing.Primitives.dll;System.Dynamic.Runtime.dll;System.Globalization.Calendars.dll;System.Globalization.dll;System.Globalization.Extensions.dll;System.IO.Compression.Brotli.dll;System.IO.Compression.dll;System.IO.Compression.FileSystem.dll;System.IO.Compression.ZipFile.dll;System.IO.dll;System.IO.FileSystem.AccessControl.dll;System.IO.FileSystem.dll;System.IO.FileSystem.DriveInfo.dll;System.IO.FileSystem.Primitives.dll;System.IO.FileSystem.Watcher.dll;System.IO.IsolatedStorage.dll;System.IO.MemoryMappedFiles.dll;System.IO.Packaging.dll;System.IO.Pipes.AccessControl.dll;System.IO.Pipes.dll;System.IO.UnmanagedMemoryStream.dll;System.Linq.dll;System.Linq.Expressions.dll;System.Linq.Parallel.dll;System.Linq.Queryable.dll;System.Memory.dll;System.Net.dll;System.Net.Http.dll;System.Net.HttpListener.dll;System.Net.Mail.dll;System.Net.NameResolution.dll;System.Net.NetworkInformation.dll;System.Net.Ping.dll;System.Net.Primitives.dll;System.Net.Requests.dll;System.Net.Security.dll;System.Net.ServicePoint.dll;System.Net.Sockets.dll;System.Net.WebClient.dll;System.Net.WebHeaderCollection.dll;System.Net.WebProxy.dll;System.Net.WebSockets.Client.dll;System.Net.WebSockets.dll;System.Numerics.dll;System.Numerics.Vectors.dll;System.ObjectModel.dll;System.Printing.dll;System.Private.CoreLib.dll;System.Private.DataContractSerialization.dll;System.Private.Uri.dll;System.Private.Xml.dll;System.Private.Xml.Linq.dll;System.Reflection.DispatchProxy.dll;System.Reflection.dll;System.Reflection.Emit.dll;System.Reflection.Emit.ILGeneration.dll;System.Reflection.Emit.Lightweight.dll;System.Reflection.Extensions.dll;System.Reflection.Metadata.dll;System.Reflection.Primitives.dll;System.Reflection.TypeExtensions.dll;System.Resources.Extensions.dll;System.Resources.Reader.dll;System.Resources.ResourceManager.dll;System.Resources.Writer.dll;System.Runtime.CompilerServices.Unsafe.dll;System.Runtime.CompilerServices.VisualC.dll;System.Runtime.dll;System.Runtime.Extensions.dll;System.Runtime.Handles.dll;System.Runtime.InteropServices.dll;System.Runtime.InteropServices.RuntimeInformation.dll;System.Runtime.InteropServices.WindowsRuntime.dll;System.Runtime.Intrinsics.dll;System.Runtime.Loader.dll;System.Runtime.Numerics.dll;System.Runtime.Serialization.dll;System.Runtime.Serialization.Formatters.dll;System.Runtime.Serialization.Json.dll;System.Runtime.Serialization.Primitives.dll;System.Runtime.Serialization.Xml.dll;System.Runtime.WindowsRuntime.dll;System.Runtime.WindowsRuntime.UI.Xaml.dll;System.Security.AccessControl.dll;System.Security.Claims.dll;System.Security.Cryptography.Algorithms.dll;System.Security.Cryptography.Cng.dll;System.Security.Cryptography.Csp.dll;System.Security.Cryptography.Encoding.dll;System.Security.Cryptography.OpenSsl.dll;System.Security.Cryptography.Pkcs.dll;System.Security.Cryptography.Primitives.dll;System.Security.Cryptography.ProtectedData.dll;System.Security.Cryptography.X509Certificates.dll;System.Security.Cryptography.Xml.dll;System.Security.dll;System.Security.Permissions.dll;System.Security.Principal.dll;System.Security.Principal.Windows.dll;System.Security.SecureString.dll;System.ServiceModel.Web.dll;System.ServiceProcess.dll;System.Text.Encoding.CodePages.dll;System.Text.Encoding.dll;System.Text.Encoding.Extensions.dll;System.Text.Encodings.Web.dll;System.Text.Json.dll;System.Text.RegularExpressions.dll;System.Threading.AccessControl.dll;System.Threading.Channels.dll;System.Threading.dll;System.Threading.Overlapped.dll;System.Threading.Tasks.Dataflow.dll;System.Threading.Tasks.dll;System.Threading.Tasks.Extensions.dll;System.Threading.Tasks.Parallel.dll;System.Threading.Thread.dll;System.Threading.ThreadPool.dll;System.Threading.Timer.dll;System.Transactions.dll;System.Transactions.Local.dll;System.ValueTuple.dll;System.Web.dll;System.Web.HttpUtility.dll;System.Windows.Controls.Ribbon.dll;System.Windows.dll;System.Windows.Extensions.dll;System.Windows.Forms.Design.dll;System.Windows.Forms.Design.Editors.dll;System.Windows.Forms.dll;System.Windows.Input.Manipulations.dll;System.Windows.Presentation.dll;System.Xaml.dll;System.Xml.dll;System.Xml.Linq.dll;System.Xml.ReaderWriter.dll;System.Xml.Serialization.dll;System.Xml.XDocument.dll;System.Xml.XmlDocument.dll;System.Xml.XmlSerializer.dll;System.Xml.XPath.dll;System.Xml.XPath.XDocument.dll;ucrtbase.dll;UIAutomationClient.dll;UIAutomationClientSideProviders.dll;UIAutomationProvider.dll;UIAutomationTypes.dll;vcamp140_app.dll;vccorlib140_app.dll;vcomp140_app.dll;vcruntime140_1_app.dll;vcruntime140_app.dll;vcruntime140_cor3.dll;WindowsBase.dll;WindowsFormsIntegration.dll;wpfgfx_cor3.dll?>
          <File Id="SettingsV2_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\$(var.File)" />
        <?endforeach?>
        <!-- dlls with hyphen -->
        <File Id="SettingsV2_api_ms_win_core_console_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-console-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_datetime_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-datetime-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_debug_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-debug-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_errorhandling_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-errorhandling-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_file_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-file-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_file_l1_2_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-file-l1-2-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_file_l2_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-file-l2-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_handle_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-handle-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_heap_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-heap-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_interlocked_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-interlocked-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_libraryloader_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-libraryloader-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_localization_l1_2_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-localization-l1-2-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_memory_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-memory-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_namedpipe_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-namedpipe-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_processenvironment_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-processenvironment-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_processthreads_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-processthreads-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_processthreads_l1_1_1.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-processthreads-l1-1-1.dll"/>
        <File Id="SettingsV2_api_ms_win_core_profile_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-profile-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_rtlsupport_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-rtlsupport-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_string_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-string-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_synch_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-synch-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_synch_l1_2_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-synch-l1-2-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_sysinfo_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-sysinfo-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_timezone_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-timezone-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_core_util_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-core-util-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_conio_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-conio-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_convert_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-convert-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_environment_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-environment-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_filesystem_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-filesystem-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_heap_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-heap-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_locale_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-locale-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_math_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-math-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_multibyte_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-multibyte-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_private_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-private-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_process_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-process-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_runtime_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-runtime-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_stdio_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-stdio-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_string_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-string-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_time_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-time-l1-1-0.dll"/>
        <File Id="SettingsV2_api_ms_win_crt_utility_l1_1_0.dll" Source="$(var.BinX64Dir)SettingsUIRunner\api-ms-win-crt-utility-l1-1-0.dll"/>
        <File Id="SettingsV2_PresentationFramework_SystemCore.dll" Source="$(var.BinX64Dir)SettingsUIRunner\PresentationFramework-SystemCore.dll"/>
        <File Id="SettingsV2_PresentationFramework_SystemData.dll" Source="$(var.BinX64Dir)SettingsUIRunner\PresentationFramework-SystemData.dll"/>
        <File Id="SettingsV2_PresentationFramework_SystemDrawing.dll" Source="$(var.BinX64Dir)SettingsUIRunner\PresentationFramework-SystemDrawing.dll"/>
        <File Id="SettingsV2_PresentationFramework_SystemXml.dll" Source="$(var.BinX64Dir)SettingsUIRunner\PresentationFramework-SystemXml.dll"/>
        <File Id="SettingsV2_PresentationFramework_SystemXmlLinq.dll" Source="$(var.BinX64Dir)SettingsUIRunner\PresentationFramework-SystemXmlLinq.dll"/>
        <!-- md -->
        <File Id="SettingsV2_SOS_README.md" Source="$(var.BinX64Dir)SettingsUIRunner\SOS_README.md"/>
        <!-- json -->
        <File Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.PowerToys.Settings.UI.Runner.deps.json"/>
        <File Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.PowerToys.Settings.UI.Runner.runtimeconfig.json"/>
        <!-- png -->
        <File Id="SettingsV2_NoiseAsset_256x256_PNG.png" Source="$(var.BinX64Dir)SettingsUIRunner\NoiseAsset_256x256_PNG.png"/>
        <!-- pri -->
        <?foreach File in Microsoft.Toolkit.Uwp.pri;Microsoft.Toolkit.Uwp.UI.pri;Microsoft.Toolkit.Win32.UI.XamlHost.pri;Microsoft.UI.Xaml.pri;Microsoft.Xaml.Interactions.pri;Microsoft.Xaml.Interactivity.pri;resources.pri?>
          <File Id="SettingsV2_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\$(var.File)" />
        <?endforeach?>
        <!-- winmd -->
        <File Id="SettingsV2_Microsoft.Toolkit.Win32.UI.XamlHost.winmd" Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.Toolkit.Win32.UI.XamlHost.winmd"/>
        <File Id="SettingsV2_Microsoft.UI.Xaml.winmd" Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.UI.Xaml.winmd"/>
        <!-- xbf -->
        <File Id="SettingsV2_App.xbf" Source="$(var.BinX64Dir)SettingsUIRunner\App.xbf"/>
        <!-- xml -->
        <File Id="SettingsV2_Microsoft.PowerToys.Settings.UI.xr.xml" Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.PowerToys.Settings.UI.xr.xml"/>
        <File Id="SettingsV2_Microsoft.Toolkit.Win32.UI.XamlHost.xml" Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.Toolkit.Win32.UI.XamlHost.xml"/>
      </Component>
    </DirectoryRef>
    <!-- .NET Core resource dlls -->
    <DirectoryRef Id="SettingsV2ResourcescsInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\cs">
      <Component Id="SettingsV2ResourcescsComponent" Guid="2F1B2163-1590-4BE4-8462-7462639556DA" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2cs_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\cs\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcesdeInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\de">
      <Component Id="SettingsV2ResourcesdeComponent" Guid="C0C56E69-3072-4DE2-A116-BF48A80DB139" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2de_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\de\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcesesInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\es">
      <Component Id="SettingsV2ResourcesesComponent" Guid="BF895884-4B6B-4269-9803-E239EED7E6F3" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2es_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\es\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcesfrInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\fr">
      <Component Id="SettingsV2ResourcesfrComponent" Guid="4D192C43-7901-4715-9925-5EE982568259" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2fr_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\fr\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcesitInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\it">
      <Component Id="SettingsV2ResourcesitComponent" Guid="861B398D-5E9E-4F6B-9779-30F15CBC65E8" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2it_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\it\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcesjaInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\ja">
      <Component Id="SettingsV2ResourcesjaComponent" Guid="0CBAD464-EF0A-4FD0-9D99-B3D8A0FF24DE" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2ja_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\ja\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourceskoInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\ko">
      <Component Id="SettingsV2ResourceskoComponent" Guid="FC8B5611-7954-4CEC-BCE5-09C329626C65" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2ko_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\ko\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcesplInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\pl">
      <Component Id="SettingsV2ResourcesplComponent" Guid="A23378A3-80E5-4CA2-A532-8A85B9B15B2A" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2pl_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\pl\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2Resourcespt_BRInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\pt-BR">
      <Component Id="SettingsV2Resourcespt_BRComponent" Guid="4D49A5EA-5F29-41BF-A69D-45E4042A8C7E" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2pt_BR_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\pt-BR\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcesruInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\ru">
      <Component Id="SettingsV2ResourcesruComponent" Guid="0ED978EB-7A55-4D6E-9414-BF6D5D6C7C1D" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2ru_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\ru\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ResourcestrInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\tr">
      <Component Id="SettingsV2ResourcestrComponent" Guid="B4129ACA-9518-4376-8974-F736F0C0395C" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2tr_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\tr\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2Resourceszh_HansInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\zh-Hans">
      <Component Id="SettingsV2Resourceszh_HansComponent" Guid="C6BEA7AA-8AED-4809-962B-FCB200A4C742" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2zh_Hans_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\zh-Hans\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2Resourceszh_HantInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\zh-Hant">
      <Component Id="SettingsV2Resourceszh_HantComponent" Guid="B5E09486-1106-4974-BD7A-7A35EEFB3A0B" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="SettingsV2zh_Hant_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\zh-Hant\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2AssetsInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\Assets">
      <Component Id="SettingsV2Assets" Guid="705B863B-D813-49B9-BAA1-210DA913F765" Win64="yes">
        <?foreach File in Logo.scale-200.png;SplashScreen.png;StoreLogo.scale-100.png?>
          <File Source="$(var.BinX64Dir)SettingsUIRunner\Assets\$(var.File)" />
        <?endforeach?>
        <File Id="SettingsV2_StoreLogo" Source="$(var.BinX64Dir)SettingsUIRunner\Assets\StoreLogo.png" />
        <File Id="Square150x150Logo" Source="$(var.BinX64Dir)SettingsUIRunner\Assets\Square150x150Logo.scale-200.png" />
        <File Id="Square44x44Logo_targetsize_24_altform_unplated" Source="$(var.BinX64Dir)SettingsUIRunner\Assets\Square44x44Logo.targetsize-24_altform-unplated.png" />
        <File Id="Wide310x150Logo" Source="$(var.BinX64Dir)SettingsUIRunner\Assets\Wide310x150Logo.scale-200.png" />
        <File Id="Square44x44Logo" Source="$(var.BinX64Dir)SettingsUIRunner\Assets\Square44x44Logo.scale-200.png" />
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ControlsInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\Controls">
      <Component Id="SettingsV2Controls" Guid="05C55C88-B59A-4450-A07C-EB7626E0781A" Win64="yes">
        <?foreach File in HotkeySettingsControl.xbf?>
          <File Id="SettingsV2_Controls_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\Controls\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2PropertiesInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\Properties">
      <Component Id="SettingsV2Properties" Guid="8F910A41-B27B-4289-8FAC-9AB34F070CF6" Win64="yes">
        <?foreach File in Default.rd.xml?>
          <File Id="SettingsV2_Properties_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\Properties\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2StylesInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\Styles">
      <Component Id="SettingsV2Styles" Guid="44B5C0E0-76DA-4604-BB86-FCD27A00EB71" Win64="yes">
        <?foreach File in Page.xbf;TextBlock.xbf;_Colors.xbf;_FontSizes.xbf;_Sizes.xbf;_Thickness.xbf?>
          <File Id="SettingsV2_Styles_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\Styles\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2ViewsInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\Views">
      <Component Id="SettingsV2Views" Guid="C140BFBA-6370-4F67-862C-5B42660385CD" Win64="yes">
        <?foreach File in FancyZonesPage.xbf;GeneralPage.xbf;ImageResizerPage.xbf;KeyboardManagerPage.xbf;PowerLauncherPage.xbf;PowerPreviewPage.xbf;PowerRenamePage.xbf;ShellPage.xbf;ShortcutGuidePage.xbf?>
          <File Id="SettingsV2_Views_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\Views\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsV2XamlAssetsInstallFolder" FileSource="$(var.BinX64Dir)SettingsUIRunner\Microsoft.UI.Xaml\Assets">
      <Component Id="SettingsV2XamlAssets" Guid="98A136DB-C1BD-42B1-9AB4-0E16F0ECE86A" Win64="yes">
        <?foreach File in NoiseAsset_256X256_PNG.png?>
          <File Id="SettingsV2_XamlAssets_$(var.File)" Source="$(var.BinX64Dir)SettingsUIRunner\Microsoft.UI.Xaml\Assets\$(var.File)" />
        <?endforeach?>
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="SettingsHtmlInstallFolder" FileSource="$(var.RepoDir)\settings\settings-html\">
      <Component Id="settings_html" Guid="87881A99-E917-4B0D-B1D8-5C6EB9709F96" Win64="yes">
        <File Source="$(var.RepoDir)\src\settings\settings-html\index.html" KeyPath="yes" />
      </Component>
      <Component Id="settings_dark_html" Guid="855866C7-2F13-4B08-B5C1-B507354C2760" Win64="yes">
        <File Source="$(var.RepoDir)\src\settings\settings-html\index-dark.html" KeyPath="yes" />
      </Component>
    </DirectoryRef>
    <DirectoryRef Id="SettingsHtmlDistInstallFolder" FileSource="$(var.RepoDir)\settings\settings-html\dist\">
      <Component Id="settings_js_bundle" Guid="9EF539C1-2F50-421E-B074-C58ED3A9785C" Win64="yes">
        <File Source="$(var.RepoDir)\src\settings\settings-html\dist\bundle.js" KeyPath="yes" />
      </Component>
    </DirectoryRef>

    <DirectoryRef Id="DesktopFolder">
      <Component Id="DesktopShortcut" Guid="87321F2B-CC48-4326-881E-9C62CC260DC8">
        <Condition>INSTALLDESKTOPSHORTCUT</Condition>
        <RegistryValue Root="HKCU"
                        Key="Software\[Manufacturer]\[ProductName]"
                        Name="desktopshorcutinstalled"
                        Type="integer"
                        Value="1"
                        KeyPath="yes"/>
        <Shortcut Id="DesktopShortcutId"
                  Name="PowerToys (Preview)"
                  Description="PowerToys - Windows system utilities to maximize productivity"
                  Target="[!PowerToys.exe]"
                  WorkingDirectory="INSTALLFOLDER"
                  Icon="powertoys.exe"
                  Directory="DesktopFolder"/>
      </Component>
    </DirectoryRef>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="CoreComponents" Directory="INSTALLFOLDER">
      <ComponentRef Id="powertoys_exe" />
      <ComponentRef Id="notifications_dll" />
      <ComponentRef Id="action_runner_exe" />
      <ComponentRef Id="powertoys_toast_clsid" />
      <ComponentRef Id="License_rtf" />
      <ComponentRef Id="powertoysinterop_dll" />
      <ComponentRef Id="PowerToysSvgs" />
      <ComponentRef Id="Module_ShortcutGuide" />
      <ComponentRef Id="Module_FancyZones" />
      <ComponentRef Id="DesktopShortcut" />
      <ComponentRef Id="Module_PowerRename" />
      <ComponentRef Id="Module_ImageResizer" />
      <ComponentRef Id="Module_ImageResizer_Registry" />
      <ComponentRef Id="Module_PowerPreview" />
      <ComponentRef Id="Module_PowerPreview_PerUserRegistry" />
      <ComponentRef Id="Module_Launcher" />
      <ComponentRef Id="Module_KeyboardManager" />
      <ComponentRef Id="SettingsV2" />
      <ComponentRef Id="SettingsV2Assets" />
      <ComponentRef Id="SettingsV2Controls" />
      <ComponentRef Id="SettingsV2Properties" />
      <ComponentRef Id="SettingsV2Styles" />
      <ComponentRef Id="SettingsV2Views" />
      <ComponentRef Id="SettingsV2XamlAssets" />
      <?foreach Language in cs;de;es;fr;it;ja;ko;pl;pt-BR;ru;tr;zh-Hans;zh-Hant?>
        <!--NB: Ids can't contain hyphens-->
        <?if $(var.Language) = pt-BR?>
          <?define IdSafeLanguage = pt_BR?>
        <?elseif $(var.Language) = zh-Hans?>
          <?define IdSafeLanguage = zh_Hans?>
        <?elseif $(var.Language) = zh-Hant?>
          <?define IdSafeLanguage = zh_Hant?>
        <?else?>
          <?define IdSafeLanguage = $(var.Language)?>
        <?endif?>
        <ComponentRef Id="SettingsV2Resources$(var.IdSafeLanguage)Component"/>
        <?undef IdSafeLanguage?>
      <?endforeach?>
      <ComponentRef Id="settings_exe" />
      <ComponentRef Id="settings_html" />
      <ComponentRef Id="settings_dark_html" />
      <ComponentRef Id="settings_js_bundle" />
    </ComponentGroup>
  </Fragment>
  <Fragment>
    <ComponentGroup Id="ResourcesComponents">
      <!-- Components for adding resource files -->
      <?foreach Language in ar;bg;ca;cs;de;es;eu-ES;fr;he;hu;it;nb-NO;nl;pl;pt-BR;ru;sk;tr;zh-Hans?>
        <!--NB: Ids can't contain hyphens-->
        <?if $(var.Language) = eu-ES?>
          <?define IdSafeLanguage = eu_ES?>
        <?elseif $(var.Language) = nb-NO?>
          <?define IdSafeLanguage = nb_NO?>
        <?elseif $(var.Language) = pt-BR?>
          <?define IdSafeLanguage = pt_BR?>
        <?elseif $(var.Language) = zh-Hans?>
          <?define IdSafeLanguage = zh_Hans?>
        <?else?>
          <?define IdSafeLanguage = $(var.Language)?>
        <?endif?>
        <Component Id="Resources_$(var.IdSafeLanguage)_Component" Directory="Resources$(var.IdSafeLanguage)Folder">
          <File Id="Resources_ImageResizer_$(var.IdSafeLanguage)_File" Source="$(var.BinX64Dir)modules\$(var.Language)\ImageResizer.resources.dll" />
        </Component>
        <?undef IdSafeLanguage?>
      <?endforeach?>
    </ComponentGroup>
  </Fragment>
  <Fragment>
    <ComponentGroup Id="LauncherComponents">
      <Component Id="launcherInstallComponent" Directory="LauncherInstallFolder" Guid="5E688DB4-C522-4268-BA54-ED1CDFFE9DB6">
        <?foreach File in Accessibility.dll;App.xbf;aspnetcorev2_inprocess.dll;clrcompression.dll;clretwrc.dll;clrjit.dll;ColorCode.Core.dll;ColorCode.UWP.dll;ColorCode.UWP.pri;concrt140_app.dll;coreclr.dll;D3DCompiler_47_cor3.dll;dbgshim.dll;DirectWriteForwarder.dll;hostfxr.dll;hostpolicy.dll;ICSharpCode.SharpZipLib.dll;JetBrains.Annotations.dll;LauncherControl.xbf;Mages.Core.dll;Microsoft.AspNetCore.Antiforgery.dll;Microsoft.AspNetCore.Authentication.Abstractions.dll;Microsoft.AspNetCore.Authentication.Cookies.dll;Microsoft.AspNetCore.Authentication.Core.dll;Microsoft.AspNetCore.Authentication.dll;Microsoft.AspNetCore.Authentication.OAuth.dll;Microsoft.AspNetCore.Authorization.dll;Microsoft.AspNetCore.Authorization.Policy.dll;Microsoft.AspNetCore.Components.Authorization.dll;Microsoft.AspNetCore.Components.dll;Microsoft.AspNetCore.Components.Forms.dll;Microsoft.AspNetCore.Components.Server.dll;Microsoft.AspNetCore.Components.Web.dll;Microsoft.AspNetCore.Connections.Abstractions.dll;Microsoft.AspNetCore.CookiePolicy.dll;Microsoft.AspNetCore.Cors.dll;Microsoft.AspNetCore.Cryptography.Internal.dll;Microsoft.AspNetCore.Cryptography.KeyDerivation.dll;Microsoft.AspNetCore.DataProtection.Abstractions.dll;Microsoft.AspNetCore.DataProtection.dll;Microsoft.AspNetCore.DataProtection.Extensions.dll;Microsoft.AspNetCore.Diagnostics.Abstractions.dll;Microsoft.AspNetCore.Diagnostics.dll;Microsoft.AspNetCore.Diagnostics.HealthChecks.dll;Microsoft.AspNetCore.dll;Microsoft.AspNetCore.HostFiltering.dll;Microsoft.AspNetCore.Hosting.Abstractions.dll;Microsoft.AspNetCore.Hosting.dll;Microsoft.AspNetCore.Hosting.Server.Abstractions.dll;Microsoft.AspNetCore.Html.Abstractions.dll;Microsoft.AspNetCore.Http.Abstractions.dll;Microsoft.AspNetCore.Http.Connections.Common.dll;Microsoft.AspNetCore.Http.Connections.dll;Microsoft.AspNetCore.Http.dll;Microsoft.AspNetCore.Http.Extensions.dll;Microsoft.AspNetCore.Http.Features.dll;Microsoft.AspNetCore.HttpOverrides.dll;Microsoft.AspNetCore.HttpsPolicy.dll;Microsoft.AspNetCore.Identity.dll;Microsoft.AspNetCore.Localization.dll;Microsoft.AspNetCore.Localization.Routing.dll;Microsoft.AspNetCore.Metadata.dll;Microsoft.AspNetCore.Mvc.Abstractions.dll;Microsoft.AspNetCore.Mvc.ApiExplorer.dll;Microsoft.AspNetCore.Mvc.Core.dll;Microsoft.AspNetCore.Mvc.Cors.dll;Microsoft.AspNetCore.Mvc.DataAnnotations.dll;Microsoft.AspNetCore.Mvc.dll;Microsoft.AspNetCore.Mvc.Formatters.Json.dll;Microsoft.AspNetCore.Mvc.Formatters.Xml.dll;Microsoft.AspNetCore.Mvc.Localization.dll;Microsoft.AspNetCore.Mvc.Razor.dll;Microsoft.AspNetCore.Mvc.RazorPages.dll;Microsoft.AspNetCore.Mvc.TagHelpers.dll;Microsoft.AspNetCore.Mvc.ViewFeatures.dll;Microsoft.AspNetCore.Razor.dll;Microsoft.AspNetCore.Razor.Runtime.dll;Microsoft.AspNetCore.ResponseCaching.Abstractions.dll;Microsoft.AspNetCore.ResponseCaching.dll;Microsoft.AspNetCore.ResponseCompression.dll;Microsoft.AspNetCore.Rewrite.dll;Microsoft.AspNetCore.Routing.Abstractions.dll;Microsoft.AspNetCore.Routing.dll;Microsoft.AspNetCore.Server.HttpSys.dll;Microsoft.AspNetCore.Server.IIS.dll;Microsoft.AspNetCore.Server.IISIntegration.dll;Microsoft.AspNetCore.Server.Kestrel.Core.dll;Microsoft.AspNetCore.Server.Kestrel.dll;Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.dll;Microsoft.AspNetCore.Session.dll;Microsoft.AspNetCore.SignalR.Common.dll;Microsoft.AspNetCore.SignalR.Core.dll;Microsoft.AspNetCore.SignalR.dll;Microsoft.AspNetCore.SignalR.Protocols.Json.dll;Microsoft.AspNetCore.StaticFiles.dll;Microsoft.AspNetCore.WebSockets.dll;Microsoft.AspNetCore.WebUtilities.dll;Microsoft.CSharp.dll;Microsoft.DiaSymReader.Native.amd64.dll;Microsoft.Extensions.Caching.Abstractions.dll;Microsoft.Extensions.Caching.Memory.dll;Microsoft.Extensions.Configuration.Abstractions.dll;Microsoft.Extensions.Configuration.Binder.dll;Microsoft.Extensions.Configuration.CommandLine.dll;Microsoft.Extensions.Configuration.dll;Microsoft.Extensions.Configuration.EnvironmentVariables.dll;Microsoft.Extensions.Configuration.FileExtensions.dll;Microsoft.Extensions.Configuration.Ini.dll;Microsoft.Extensions.Configuration.Json.dll;Microsoft.Extensions.Configuration.KeyPerFile.dll;Microsoft.Extensions.Configuration.UserSecrets.dll;Microsoft.Extensions.Configuration.Xml.dll;Microsoft.Extensions.DependencyInjection.Abstractions.dll;Microsoft.Extensions.DependencyInjection.dll;Microsoft.Extensions.Diagnostics.HealthChecks.Abstractions.dll;Microsoft.Extensions.Diagnostics.HealthChecks.dll;Microsoft.Extensions.FileProviders.Abstractions.dll;Microsoft.Extensions.FileProviders.Composite.dll;Microsoft.Extensions.FileProviders.Embedded.dll;Microsoft.Extensions.FileProviders.Physical.dll;Microsoft.Extensions.FileSystemGlobbing.dll;Microsoft.Extensions.Hosting.Abstractions.dll;Microsoft.Extensions.Hosting.dll;Microsoft.Extensions.Http.dll;Microsoft.Extensions.Identity.Core.dll;Microsoft.Extensions.Identity.Stores.dll;Microsoft.Extensions.Localization.Abstractions.dll;Microsoft.Extensions.Localization.dll;Microsoft.Extensions.Logging.Abstractions.dll;Microsoft.Extensions.Logging.Configuration.dll;Microsoft.Extensions.Logging.Console.dll;Microsoft.Extensions.Logging.Debug.dll;Microsoft.Extensions.Logging.dll;Microsoft.Extensions.Logging.EventLog.dll;Microsoft.Extensions.Logging.EventSource.dll;Microsoft.Extensions.Logging.TraceSource.dll;Microsoft.Extensions.ObjectPool.dll;Microsoft.Extensions.Options.ConfigurationExtensions.dll;Microsoft.Extensions.Options.DataAnnotations.dll;Microsoft.Extensions.Options.dll;Microsoft.Extensions.Primitives.dll;Microsoft.Extensions.WebEncoders.dll;Microsoft.Graphics.Canvas.dll;Microsoft.Graphics.Canvas.winmd;Microsoft.JSInterop.dll;Microsoft.Net.Http.Headers.dll;Microsoft.PowerToys.Settings.UI.Lib.dll;Microsoft.Search.Interop.dll;Microsoft.Toolkit.dll;Microsoft.Toolkit.Parsers.dll;Microsoft.Toolkit.Uwp.dll;Microsoft.Toolkit.Uwp.pri;Microsoft.Toolkit.Uwp.UI.Animations.dll;Microsoft.Toolkit.Uwp.UI.Animations.pri;Microsoft.Toolkit.Uwp.UI.Controls.dll;Microsoft.Toolkit.Uwp.UI.Controls.pri;Microsoft.Toolkit.Uwp.UI.dll;Microsoft.Toolkit.Uwp.UI.pri;Microsoft.Toolkit.Win32.UI.XamlHost.dll;Microsoft.Toolkit.Win32.UI.XamlHost.Managed.dll;Microsoft.Toolkit.Win32.UI.XamlHost.pri;Microsoft.Toolkit.Win32.UI.XamlHost.winmd;Microsoft.Toolkit.Win32.UI.XamlHost.xml;Microsoft.Toolkit.Wpf.UI.XamlHost.dll;Microsoft.UI.Xaml.dll;Microsoft.UI.Xaml.pri;Microsoft.UI.Xaml.winmd;Microsoft.VisualBasic.Core.dll;Microsoft.VisualBasic.dll;Microsoft.Win32.Primitives.dll;Microsoft.Win32.Registry.AccessControl.dll;Microsoft.Win32.Registry.dll;Microsoft.Win32.SystemEvents.dll;Microsoft.Xaml.Interactions.dll;Microsoft.Xaml.Interactions.pri;Microsoft.Xaml.Interactivity.dll;Microsoft.Xaml.Interactivity.pri;Mono.Cecil.dll;Mono.Cecil.Mdb.dll;Mono.Cecil.Pdb.dll;Mono.Cecil.Rocks.dll;mscordaccore.dll;mscordaccore_amd64_amd64_4.700.20.11803.dll;mscordbi.dll;mscorlib.dll;mscorrc.debug.dll;mscorrc.dll;msvcp140_1_app.dll;msvcp140_2_app.dll;msvcp140_app.dll;netstandard.dll;Newtonsoft.Json.dll;NHotkey.dll;NHotkey.Wpf.dll;NLog.dll;NLog.Extensions.Logging.dll;NLog.Web.AspNetCore.dll;NoiseAsset_256x256_PNG.png;PenImc_cor3.dll;Pinyin4Net.dll;PowerLauncher.deps.json;PowerLauncher.dll;PowerLauncher.exe;PowerLauncher.runtimeconfig.json;PowerLauncher.UI.exe;PowerLauncher.UI.xr.xml;PowerToysInterop.dll;PresentationCore.dll;PresentationFramework.Aero.dll;PresentationFramework.Aero2.dll;PresentationFramework.AeroLite.dll;PresentationFramework.Classic.dll;PresentationFramework.dll;PresentationFramework.Luna.dll;PresentationFramework.Royale.dll;PresentationNative_cor3.dll;PresentationUI.dll;PropertyChanged.dll;ReachFramework.dll;resources.pri;ResultList.xbf;SOS_README.md;SQLite.Interop.dll;System.AppContext.dll;System.Buffers.dll;System.CodeDom.dll;System.Collections.Concurrent.dll;System.Collections.dll;System.Collections.Immutable.dll;System.Collections.NonGeneric.dll;System.Collections.Specialized.dll;System.ComponentModel.Annotations.dll;System.ComponentModel.Composition.dll;System.ComponentModel.DataAnnotations.dll;System.ComponentModel.dll;System.ComponentModel.EventBasedAsync.dll;System.ComponentModel.Primitives.dll;System.ComponentModel.TypeConverter.dll;System.Configuration.ConfigurationManager.dll;System.Configuration.dll;System.Console.dll;System.Core.dll;System.Data.Common.dll;System.Data.DataSetExtensions.dll;System.Data.dll;System.Data.OleDb.dll;System.Data.SqlClient.dll;System.Data.SQLite.dll;System.Design.dll;System.Diagnostics.Contracts.dll;System.Diagnostics.Debug.dll;System.Diagnostics.DiagnosticSource.dll;System.Diagnostics.EventLog.dll;System.Diagnostics.FileVersionInfo.dll;System.Diagnostics.PerformanceCounter.dll;System.Diagnostics.Process.dll;System.Diagnostics.StackTrace.dll;System.Diagnostics.TextWriterTraceListener.dll;System.Diagnostics.Tools.dll;System.Diagnostics.TraceSource.dll;System.Diagnostics.Tracing.dll;System.DirectoryServices.dll;System.dll;System.Drawing.Common.dll;System.Drawing.Design.dll;System.Drawing.dll;System.Drawing.Primitives.dll;System.Dynamic.Runtime.dll;System.Globalization.Calendars.dll;System.Globalization.dll;System.Globalization.Extensions.dll;System.IO.Compression.Brotli.dll;System.IO.Compression.dll;System.IO.Compression.FileSystem.dll;System.IO.Compression.ZipFile.dll;System.IO.dll;System.IO.FileSystem.AccessControl.dll;System.IO.FileSystem.dll;System.IO.FileSystem.DriveInfo.dll;System.IO.FileSystem.Primitives.dll;System.IO.FileSystem.Watcher.dll;System.IO.IsolatedStorage.dll;System.IO.MemoryMappedFiles.dll;System.IO.Packaging.dll;System.IO.Pipelines.dll;System.IO.Pipes.AccessControl.dll;System.IO.Pipes.dll;System.IO.Ports.dll;System.IO.UnmanagedMemoryStream.dll;System.Linq.dll;System.Linq.Expressions.dll;System.Linq.Parallel.dll;System.Linq.Queryable.dll;System.Memory.dll;System.Net.dll;System.Net.Http.dll;System.Net.Http.Rtc.dll;System.Net.HttpListener.dll;System.Net.Mail.dll;System.Net.NameResolution.dll;System.Net.NetworkInformation.dll;System.Net.Ping.dll;System.Net.Primitives.dll;System.Net.Requests.dll;System.Net.Security.dll;System.Net.ServicePoint.dll;System.Net.Sockets.dll;System.Net.WebClient.dll;System.Net.WebHeaderCollection.dll;System.Net.WebProxy.dll;System.Net.WebSockets.Client.dll;System.Net.WebSockets.dll;System.Numerics.dll;System.Numerics.Vectors.dll;System.Numerics.Vectors.WindowsRuntime.dll;System.ObjectModel.dll;System.Printing.dll;System.Private.CoreLib.dll;System.Private.DataContractSerialization.dll;System.Private.Reflection.Metadata.Ecma335.dll;System.Private.ServiceModel.dll;System.Private.Uri.dll;System.Private.Xml.dll;System.Private.Xml.Linq.dll;System.Reflection.Context.dll;System.Reflection.DispatchProxy.dll;System.Reflection.dll;System.Reflection.Emit.dll;System.Reflection.Emit.ILGeneration.dll;System.Reflection.Emit.Lightweight.dll;System.Reflection.Extensions.dll;System.Reflection.Metadata.dll;System.Reflection.Primitives.dll;System.Reflection.TypeExtensions.dll;System.Resources.Extensions.dll;System.Resources.Reader.dll;System.Resources.ResourceManager.dll;System.Resources.Writer.dll;System.Runtime.CompilerServices.Unsafe.dll;System.Runtime.CompilerServices.VisualC.dll;System.Runtime.dll;System.Runtime.Extensions.dll;System.Runtime.Handles.dll;System.Runtime.InteropServices.dll;System.Runtime.InteropServices.RuntimeInformation.dll;System.Runtime.InteropServices.WindowsRuntime.dll;System.Runtime.Intrinsics.dll;System.Runtime.Loader.dll;System.Runtime.Numerics.dll;System.Runtime.Serialization.dll;System.Runtime.Serialization.Formatters.dll;System.Runtime.Serialization.Json.dll;System.Runtime.Serialization.Primitives.dll;System.Runtime.Serialization.Xml.dll;System.Runtime.WindowsRuntime.dll;System.Runtime.WindowsRuntime.UI.Xaml.dll;System.Security.AccessControl.dll;System.Security.Claims.dll;System.Security.Cryptography.Algorithms.dll;System.Security.Cryptography.Cng.dll;System.Security.Cryptography.Csp.dll;System.Security.Cryptography.Encoding.dll;System.Security.Cryptography.OpenSsl.dll;System.Security.Cryptography.Pkcs.dll;System.Security.Cryptography.Primitives.dll;System.Security.Cryptography.ProtectedData.dll;System.Security.Cryptography.X509Certificates.dll;System.Security.Cryptography.Xml.dll;System.Security.dll;System.Security.Permissions.dll;System.Security.Principal.dll;System.Security.Principal.Windows.dll;System.Security.SecureString.dll;System.ServiceModel.dll;System.ServiceModel.Duplex.dll;System.ServiceModel.Http.dll;System.ServiceModel.NetTcp.dll;System.ServiceModel.Primitives.dll;System.ServiceModel.Security.dll;System.ServiceModel.Web.dll;System.ServiceProcess.dll;System.Text.Encoding.CodePages.dll;System.Text.Encoding.dll;System.Text.Encoding.Extensions.dll;System.Text.Encodings.Web.dll;System.Text.Json.dll;System.Text.RegularExpressions.dll;System.Threading.AccessControl.dll;System.Threading.Channels.dll;System.Threading.dll;System.Threading.Overlapped.dll;System.Threading.Tasks.Dataflow.dll;System.Threading.Tasks.dll;System.Threading.Tasks.Extensions.dll;System.Threading.Tasks.Parallel.dll;System.Threading.Thread.dll;System.Threading.ThreadPool.dll;System.Threading.Timer.dll;System.Transactions.dll;System.Transactions.Local.dll;System.ValueTuple.dll;System.Web.dll;System.Web.HttpUtility.dll;System.Windows.Controls.Ribbon.dll;System.Windows.dll;System.Windows.Extensions.dll;System.Windows.Forms.Design.dll;System.Windows.Forms.Design.Editors.dll;System.Windows.Forms.dll;System.Windows.Input.Manipulations.dll;System.Windows.Presentation.dll;System.Xaml.dll;System.Xml.dll;System.Xml.Linq.dll;System.Xml.ReaderWriter.dll;System.Xml.Serialization.dll;System.Xml.XDocument.dll;System.Xml.XmlDocument.dll;System.Xml.XmlSerializer.dll;System.Xml.XPath.dll;System.Xml.XPath.XDocument.dll;ucrtbase.dll;UIAutomationClient.dll;UIAutomationClientSideProviders.dll;UIAutomationProvider.dll;UIAutomationTypes.dll;vcamp140_app.dll;vccorlib140_app.dll;vcomp140_app.dll;vcruntime140_1_app.dll;vcruntime140_app.dll;vcruntime140_cor3.dll;WindowsBase.dll;WindowsFormsIntegration.dll;WindowsInput.dll;Wox.Core.deps.json;Wox.Core.dll;Wox.deps.json;Wox.dll;Wox.exe;Wox.Infrastructure.deps.json;Wox.Infrastructure.dll;Wox.Plugin.deps.json;Wox.Plugin.dll;Wox.runtimeconfig.json;wpfgfx_cor3.dll?>
          <File Id="Launcher_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\$(var.File)" />
        <?endforeach?>
      <!-- dlls with hyphen -->
      <File Id="Launcher_api_ms_win_core_console_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-console-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_datetime_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-datetime-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_debug_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-debug-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_errorhandling_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-errorhandling-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_file_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-file-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_file_l1_2_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-file-l1-2-0.dll"/>
      <File Id="Launcher_api_ms_win_core_file_l2_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-file-l2-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_handle_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-handle-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_heap_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-heap-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_interlocked_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-interlocked-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_libraryloader_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-libraryloader-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_localization_l1_2_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-localization-l1-2-0.dll"/>
      <File Id="Launcher_api_ms_win_core_memory_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-memory-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_namedpipe_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-namedpipe-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_processenvironment_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-processenvironment-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_processthreads_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-processthreads-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_processthreads_l1_1_1.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-processthreads-l1-1-1.dll"/>
      <File Id="Launcher_api_ms_win_core_profile_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-profile-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_rtlsupport_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-rtlsupport-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_string_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-string-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_synch_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-synch-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_synch_l1_2_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-synch-l1-2-0.dll"/>
      <File Id="Launcher_api_ms_win_core_sysinfo_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-sysinfo-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_timezone_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-timezone-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_core_util_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-core-util-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_conio_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-conio-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_convert_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-convert-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_environment_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-environment-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_filesystem_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-filesystem-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_heap_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-heap-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_locale_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-locale-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_math_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-math-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_multibyte_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-multibyte-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_private_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-private-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_process_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-process-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_runtime_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-runtime-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_stdio_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-stdio-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_string_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-string-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_time_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-time-l1-1-0.dll"/>
      <File Id="Launcher_api_ms_win_crt_utility_l1_1_0.dll" Source="$(var.BinX64Dir)modules\launcher\api-ms-win-crt-utility-l1-1-0.dll"/>
      <File Id="Launcher_PresentationFramework_SystemCore.dll" Source="$(var.BinX64Dir)modules\launcher\PresentationFramework-SystemCore.dll"/>
      <File Id="Launcher_PresentationFramework_SystemData.dll" Source="$(var.BinX64Dir)modules\launcher\PresentationFramework-SystemData.dll"/>
      <File Id="Launcher_PresentationFramework_SystemDrawing.dll" Source="$(var.BinX64Dir)modules\launcher\PresentationFramework-SystemDrawing.dll"/>
      <File Id="Launcher_PresentationFramework_SystemXml.dll" Source="$(var.BinX64Dir)modules\launcher\PresentationFramework-SystemXml.dll"/>
      <File Id="Launcher_PresentationFramework_SystemXmlLinq.dll" Source="$(var.BinX64Dir)modules\launcher\PresentationFramework-SystemXmlLinq.dll"/>
      </Component>
      
      <!-- .NET Core resource dlls -->
      <Component Id="LauncherResourcescsComponent" Directory="LauncherResourcescsInstallFolder" Guid="8F6DC954-D5DE-4CA3-A990-66FFBAD25137" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launchercs_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\cs\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcesdeComponent" Directory="LauncherResourcesdeInstallFolder" Guid="AEEDE72D-B277-4A13-A93A-FC810278C2C9" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherde_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\de\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcesesComponent" Directory="LauncherResourcesesInstallFolder" Guid="6F1E1A77-F9AB-4032-9195-3BD72EB3DBEF" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcheres_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\es\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcesfrComponent" Directory="LauncherResourcesfrInstallFolder" Guid="26349891-16F1-4F86-948C-F5F8D1A69DBC" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherfr_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\fr\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcesitComponent" Directory="LauncherResourcesitInstallFolder" Guid="69B0EC0F-9307-4946-96AD-9EA172F8FF01" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherit_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\it\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcesjaComponent" Directory="LauncherResourcesjaInstallFolder" Guid="BE71CBEE-AEBF-4DFA-B29C-9D4C1555FDBD" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherja_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\ja\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourceskoComponent" Directory="LauncherResourceskoInstallFolder" Guid="0E3A435C-885F-4BE8-A94F-6398AF9795E9" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherko_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\ko\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcesplComponent" Directory="LauncherResourcesplInstallFolder" Guid="30F2F679-6D6E-4686-AEE8-AE6E3AB56A29" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherpl_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\pl\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcespt_BRComponent" Directory="LauncherResourcespt_BRInstallFolder" Guid="529CE1D9-CDFF-4BB7-9B56-96D89C493672" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherpt_BR_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\pt-BR\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcesruComponent" Directory="LauncherResourcesruInstallFolder" Guid="F666D0E2-9D5B-4A94-99AC-34318D54F3DA" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherru_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\ru\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourcestrComponent" Directory="LauncherResourcestrInstallFolder" Guid="1456F37E-82B3-4F7F-B241-7F381277E3BC" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launchertr_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\tr\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourceszh_HansComponent" Directory="LauncherResourceszh_HansInstallFolder" Guid="D7143AE8-CE6C-4264-920B-56007257BA99" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherzh_Hans_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\zh-Hans\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="LauncherResourceszh_HantComponent" Directory="LauncherResourceszh_HantInstallFolder" Guid="661D1814-F380-4C6D-A110-C07480CD0B84" Win64="yes">
        <?foreach File in PresentationCore.resources.dll;PresentationFramework.resources.dll;PresentationUI.resources.dll;ReachFramework.resources.dll;System.Printing.resources.dll;System.Windows.Controls.Ribbon.resources.dll;System.Windows.Forms.Design.Editors.resources.dll;System.Windows.Forms.Design.resources.dll;System.Windows.Forms.resources.dll;System.Windows.Input.Manipulations.resources.dll;System.Xaml.resources.dll;UIAutomationClient.resources.dll;UIAutomationClientSideProviders.resources.dll;UIAutomationProvider.resources.dll;UIAutomationTypes.resources.dll;WindowsBase.resources.dll;WindowsFormsIntegration.resources.dll?>
          <File Id="Launcherzh_Hant_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\zh-Hant\$(var.File)" />
        <?endforeach?>
      </Component>
      
      <Component Id="launcherAssetsComponent" Directory="AssetsFolder" Guid="6A86A414-D68B-49F0-A7AD-A342528D7ACD">
        <?foreach File in LockScreenLogo.scale-200.png;SplashScreen.scale-200.png;Square150x150Logo.scale-200.png;Square44x44Logo.scale-200.png;Square44x44Logo.targetsize-24_altform-unplated.png;StoreLogo.png;Wide310x150Logo.scale-200.png?>
          <File Source="$(var.BinX64Dir)modules\launcher\Assets\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="launcherImagesComponent" Directory="LauncherImagesFolder" Guid="D254220C-1DD9-4C74-8810-1AAB2F940DE8">
        <?foreach File in app.png;app_error.png;Browser.png;calculator.png;cancel.png;close.png;cmd.png;color.png;copy.png;down.png;EXE.png;file.png;find.png;folder.png;history.png;image.png;Link.png;lock.png;logoff.png;ok.png;open.png;plugin.png;recyclebin.png;restart.png;search.png;settings.png;shutdown.png;sleep.png;up.png;update.png;warning.png?>
          <File Id="File_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Images\$(var.File)" />
        <?endforeach?>
        <File Source="$(var.BinX64Dir)modules\launcher\Images\New Message.png" />
      </Component>
      <Component Id="launcherUIControlsComponent" Directory="LauncherUIControlsFolder" Guid="9C6C3785-D6FB-468A-9BEC-130F0403E7F8">
          <File Source="$(var.BinX64Dir)modules\launcher\Microsoft.Toolkit.Uwp.UI.Controls\Microsoft.Toolkit.Uwp.UI.Controls.xr.xml" />
      </Component>
      <Component Id="launcherXamlAssetsComponent" Directory="XamlUIAssetsFolder" Guid="C7ECA65E-73D3-4C02-A6FA-FD1E3215CC48">
          <File Source="$(var.BinX64Dir)modules\launcher\Microsoft.UI.Xaml\Assets\NoiseAsset_256X256_PNG.png" />
      </Component>
      <Component Id="launcherpinyinComponent" Directory="LauncherpinyindbFolder" Guid="F9EA53C7-D6AE-4E62-9800-0D32FBBD9F65">
        <?foreach File in pinyin_gwoyeu_mapping.xml;pinyin_mapping.xml;unicode_to_hanyu_pinyin.txt?>
          <File Source="$(var.BinX64Dir)modules\launcher\pinyindb\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="launcherPropertiesComponent" Directory="LauncherPropertiesFolder" Guid="5C18CDB8-DBBB-4D53-A935-943347BC6310">
        <File Source="$(var.BinX64Dir)modules\launcher\Properties\Default.rd.xml" />
      </Component>
      
      <!-- Calculator Plugin -->
      <Component Id="calculatorComponent" Directory="CalculatorPluginFolder" Guid="19DE1022-583C-4969-9AFC-D43CB944003D">
        <?foreach File in plugin.json;Wox.Infrastructure.dll;Wox.Plugin.Caculator.deps.json;Wox.Plugin.Caculator.dll;Wox.Plugin.dll?>
          <File Id="Calculator_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Caculator\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="calculatorImagesComponent" Directory="CalculatorImagesFolder" Guid="07EC9232-CF9A-4CDB-8D8E-E79DC75096C0">
        <File Id="calculatorPluginImg" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Caculator\Images\calculator.png" />
      </Component>
       <Component Id="calculatorLanguagesComponent" Directory="CalculatorLanguagesFolder" Guid="2D8019E7-664F-4529-9FAA-83C8DACF0732">
        <?foreach LanguageFile in de.xaml;en.xaml;pl.xaml;tr.xaml;zh-cn.xaml;zh-tw.xaml?>
          <!--NB: Ids can't contain hyphens-->
          <?if $(var.LanguageFile) = zh-cn.xaml?>
            <?define IdSafeLanguage = zh_cn.xaml?>
          <?elseif $(var.LanguageFile) = zh-tw.xaml?>
            <?define IdSafeLanguage = zh_tw.xaml?>
          <?else?>
            <?define IdSafeLanguage = $(var.LanguageFile)?>
          <?endif?>
          <File Id="File_calc_Plugin_$(var.IdSafeLanguage)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Caculator\Languages\$(var.LanguageFile)" />
          <?undef IdSafeLanguage?>
        <?endforeach?>
      </Component>
      <Component Id="calculatorpinyindbComponent" Directory="CalculatorpinyindbFolder" Guid="D5527670-BE9A-4AA9-9D36-1249F2184B5B">
        <?foreach File in pinyin_gwoyeu_mapping.xml;pinyin_mapping.xml;unicode_to_hanyu_pinyin.txt?>
          <File Id="CalcPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Caculator\pinyindb\$(var.File)" />
        <?endforeach?>
      </Component>

      <!-- Folder Plugin -->
      <Component Id="FolderComponent" Directory="FolderPluginFolder" Guid="453D6C29-8F0D-46EC-B210-82E6AF547039">
        <?foreach File in plugin.json;Wox.Infrastructure.dll;Wox.Plugin.Folder.deps.json;Wox.Plugin.Folder.dll;Wox.Plugin.dll?>
        <File Id="Folder_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Folder\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="FolderImagesComponent" Directory="FolderPluginImagesFolder" Guid="6C5226EB-E312-4768-B4D1-B1D3ACFCCBDF">
        <?foreach File in copy.png;deletefilefolder.png;file.png;folder.png;user.png?>
          <File Id="FolderPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Folder\Images\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="FolderPluginLanguagesComponent" Directory="FolderPluginLanguagesFolder" Guid="6316D847-5FD2-488B-A60E-5517BF95A25C">
        <?foreach LanguageFile in de.xaml;en.xaml;pl.xaml;tr.xaml;zh-cn.xaml;zh-tw.xaml?>
          <!--NB: Ids can't contain hyphens-->
          <?if $(var.LanguageFile) = zh-cn.xaml?>
            <?define IdSafeLanguage = zh_cn.xaml?>
          <?elseif $(var.LanguageFile) = zh-tw.xaml?>
            <?define IdSafeLanguage = zh_tw.xaml?>
          <?else?>
            <?define IdSafeLanguage = $(var.LanguageFile)?>
          <?endif?>
            <File Id="File_Folder_Plugin_$(var.IdSafeLanguage)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Folder\Languages\$(var.LanguageFile)" />
          <?undef IdSafeLanguage?>
        <?endforeach?>
      </Component>
      <Component Id="FolderPluginpinyindbComponent" Directory="FolderPluginpinyindbFolder" Guid="233BE087-B9DC-408A-8809-593C42DE8B1B">
        <?foreach File in pinyin_gwoyeu_mapping.xml;pinyin_mapping.xml;unicode_to_hanyu_pinyin.txt?>
          <File Id="FolderPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Folder\pinyindb\$(var.File)" />
        <?endforeach?>
      </Component>
    
      <!-- Program Plugin -->
      <Component Id="ProgramComponent" Directory="ProgramPluginFolder" Guid="3C5CA6E6-3D36-4F4E-B40E-38AA5E5CB799">
        <?foreach File in AppxPackagingTlb.dll;plugin.json;ShObjIdlTlb.dll;Wox.Infrastructure.dll;Wox.Plugin.dll;Wox.Plugin.Program.deps.json;Wox.Plugin.Program.dll?>
          <File Id="Program_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Program\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="ProgramImagesComponent" Directory="ProgramImagesFolder" Guid="30D357F5-406F-47D1-BEFE-6022746469B4">
        <?foreach File in cmd.png;disable.png;folder.png;program.png;user.png?>
          <File Id="Program_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Program\Images\$(var.File)" />
        <?endforeach?>
      </Component>
       <Component Id="ProgramLanguagesComponent" Directory="ProgramLanguagesFolder" Guid="EBFF53B6-3602-4F55-8784-FC7DB29D3D62">
        <?foreach LanguageFile in de.xaml;en.xaml;pl.xaml;tr.xaml;zh-cn.xaml;zh-tw.xaml?>
          <!--NB: Ids can't contain hyphens-->
          <?if $(var.LanguageFile) = zh-cn.xaml?>
            <?define IdSafeLanguage = zh_cn.xaml?>
          <?elseif $(var.LanguageFile) = zh-tw.xaml?>
            <?define IdSafeLanguage = zh_tw.xaml?>
          <?else?>
            <?define IdSafeLanguage = $(var.LanguageFile)?>
          <?endif?>
          <File Id="File_Program_Plugin_$(var.IdSafeLanguage)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Program\Languages\$(var.LanguageFile)" />
          <?undef IdSafeLanguage?>
        <?endforeach?>
      </Component>
      <Component Id="ProgrampinyindbComponent" Directory="ProgrampinyindbFolder" Guid="65A488C3-C67D-45F7-9654-6DF529AEEB3F">
        <?foreach File in pinyin_gwoyeu_mapping.xml;pinyin_mapping.xml;unicode_to_hanyu_pinyin.txt?>
          <File Id="ProgramPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Program\pinyindb\$(var.File)" />
        <?endforeach?>
      </Component>
    
      <!-- Shell Plugin -->
      <Component Id="ShellComponent" Directory="ShellPluginFolder" Guid="6D3D7294-1804-47C9-83E5-47A8867F3801">
        <?foreach File in plugin.json;Wox.Infrastructure.dll;Wox.Plugin.dll;Wox.Plugin.Shell.deps.json;Wox.Plugin.Shell.dll?>
          <File Id="Shell_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Shell\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="ShellImagesComponent" Directory="ShellImagesFolder" Guid="15B5DBAE-E7C1-4BF7-A29E-6CE76242F8F4">
        <File Id="ShellPluginImg" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Shell\Images\shell.png" />
        <File Id="ShellPluginUserImg" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Shell\Images\user.png" />
      </Component>
       <Component Id="ShellLanguagesComponent" Directory="ShellLanguagesFolder" Guid="4190F789-8A66-46AA-B920-C76CB29277D7">
        <?foreach LanguageFile in de.xaml;en.xaml;pl.xaml;tr.xaml;zh-cn.xaml;zh-tw.xaml?>
          <!--NB: Ids can't contain hyphens-->
          <?if $(var.LanguageFile) = zh-cn.xaml?>
            <?define IdSafeLanguage = zh_cn.xaml?>
          <?elseif $(var.LanguageFile) = zh-tw.xaml?>
            <?define IdSafeLanguage = zh_tw.xaml?>
          <?else?>
            <?define IdSafeLanguage = $(var.LanguageFile)?>
          <?endif?>
          <File Id="File_Shell_Plugin_$(var.IdSafeLanguage)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Shell\Languages\$(var.LanguageFile)" />
          <?undef IdSafeLanguage?>
        <?endforeach?>
      </Component>
      <Component Id="ShellpinyindbComponent" Directory="ShellpinyindbFolder" Guid="A60742F3-2187-47F2-A5B5-300E44837DD7">
        <?foreach File in pinyin_gwoyeu_mapping.xml;pinyin_mapping.xml;unicode_to_hanyu_pinyin.txt?>
          <File Id="ShellPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.Shell\pinyindb\$(var.File)" />
        <?endforeach?>
      </Component>

      <!-- Indexer Plugin -->
      <Component Id="IndexerComponent" Directory="IndexerPluginFolder" Guid="FEA9816A-B4F7-42CC-99AF-B05F3E7F7EBF">
        <?foreach File in Microsoft.Plugin.Indexer.deps.json;Microsoft.Plugin.Indexer.dll;plugin.json;Wox.Infrastructure.dll?>
          <File Id="Indexer_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Microsoft.Plugin.Indexer\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="IndexerImagesComponent" Directory="IndexerImagesFolder" Guid="DB2E8D49-D104-425B-9616-952AC8CAB676">
        <File Id="IndexerPluginImg" Source="$(var.BinX64Dir)modules\launcher\Plugins\Microsoft.Plugin.Indexer\Images\WindowsIndexerImg.bmp" />
      </Component>
      <Component Id="IndexerpinyindbComponent" Directory="IndexerpinyindbFolder" Guid="48DE333A-80F8-400A-87F4-244DF0A2DB05">
        <?foreach File in pinyin_gwoyeu_mapping.xml;pinyin_mapping.xml;unicode_to_hanyu_pinyin.txt?>
          <File Id="IndexerPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Microsoft.Plugin.Indexer\pinyindb\$(var.File)" />
        <?endforeach?>
      </Component>

      <!-- WindowWalker Plugin -->  
      <Component Id="WindowWalkerComponent" Directory="WindowWalkerPluginFolder" Guid="EB1391C9-B701-421F-80FC-ABB2FEDFAD19">
        <?foreach File in plugin.json;Wox.Infrastructure.dll;Wox.Plugin.dll;Wox.Plugin.WindowWalker.deps.json;Wox.Plugin.WindowWalker.dll?>
          <File Id="WindowWalker_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.WindowWalker\$(var.File)" />
        <?endforeach?>
      </Component>
      <Component Id="WindowWalkerImagesComponent" Directory="WindowWalkerImagesFolder" Guid="3944A7F5-77F4-4979-9911-EDE709B2F509">
          <File Id="WindowWalkerIcon" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.WindowWalker\Images\windowwalker.png" />
      </Component>
      <Component Id="WindowWalkerLanguagesComponent" Directory="WindowWalkerLanguagesFolder" Guid="7D9471D9-5C0A-4BD1-9A01-BAB65DD58834">
        <File Id="WindowWalkerLanguage" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.WindowWalker\Languages\en.xaml" />
      </Component>
      <Component Id="WindowWalkerpinyindbComponent" Directory="WindowWalkerpinyindbFolder" Guid="02C7A758-CDD4-4E27-9EC7-2ED68DC444B0">
        <?foreach File in pinyin_gwoyeu_mapping.xml;pinyin_mapping.xml;unicode_to_hanyu_pinyin.txt?>
          <File Id="WindowWalkerPlugin_$(var.File)" Source="$(var.BinX64Dir)modules\launcher\Plugins\Wox.Plugin.WindowWalker\pinyindb\$(var.File)" />
        <?endforeach?>
      </Component>
    
    </ComponentGroup>
  </Fragment>
</Wix>
